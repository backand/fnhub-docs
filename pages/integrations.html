
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="../stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="../javascripts/all_nosearch.js"></script>
  </head>

  <body class="pages pages_integrations" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="../images/logo.png" class="logo" alt="Logo" />
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#integrations" class="toc-h1 toc-link" data-title="Integrations">Integrations</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#todo-app-with-users" class="toc-h2 toc-link" data-title="Integrations">ToDo App with users</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#restful-api-out-of-the-box" class="toc-h3 toc-link" data-title="Integrations">RESTful API Out-of-the-Box</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#security-roles" class="toc-h3 toc-link" data-title="Integrations">Security Roles</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#login-and-anonymous-access" class="toc-h3 toc-link" data-title="Integrations">Login and Anonymous Access</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#remaining-items" class="toc-h3 toc-link" data-title="Integrations">Remaining Items</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#summary" class="toc-h3 toc-link" data-title="Integrations">Summary</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#ionic-with-backand" class="toc-h2 toc-link" data-title="Integrations">Ionic With Backand</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#what-is-ionic" class="toc-h3 toc-link" data-title="Integrations">What is Ionic?</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#the-perfect-recipe-for-building-mobile-apps" class="toc-h3 toc-link" data-title="Integrations">The Perfect Recipe for Building Mobile Apps</a>
                            <!-- Nest 4 levels -->
                              <ul class="toc-list-h4">
                                  <li>
                                    <a href="#backand" class="toc-h4 toc-link" data-title="Integrations">Backand</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                                  <li>
                                    <a href="#ionic" class="toc-h4 toc-link" data-title="Integrations">Ionic</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                                  <li>
                                    <a href="#js-libraries" class="toc-h4 toc-link" data-title="Integrations">JS Libraries</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                                  <li>
                                    <a href="#authorization" class="toc-h4 toc-link" data-title="Integrations">Authorization</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                                  <li>
                                    <a href="#sign-in" class="toc-h4 toc-link" data-title="Integrations">Sign In</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                                  <li>
                                    <a href="#crud" class="toc-h4 toc-link" data-title="Integrations">CRUD</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                                  <li>
                                    <a href="#using-backand-data" class="toc-h4 toc-link" data-title="Integrations">Using Backand Data</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                              </ul>
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#retrieving-data-from-facebook-using-the-graph-api" class="toc-h2 toc-link" data-title="Integrations">Retrieving data from Facebook using the Graph API</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#obtaining-the-facebook-user-id" class="toc-h3 toc-link" data-title="Integrations">Obtaining the Facebook User ID</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#obtaining-the-facebook-access-token" class="toc-h3 toc-link" data-title="Integrations">Obtaining the Facebook Access token</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#getting-facebook-data-into-backand-code" class="toc-h3 toc-link" data-title="Integrations">Getting Facebook data into Backand code</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#getting-a-facebook-profile-image" class="toc-h3 toc-link" data-title="Integrations">Getting a Facebook profile image</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#amazon-aws-and-s3-integrations" class="toc-h2 toc-link" data-title="Integrations">Amazon AWS and S3 Integrations</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#a-quick-s3-overview" class="toc-h3 toc-link" data-title="Integrations">A Quick S3 Overview</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#server-side-action" class="toc-h3 toc-link" data-title="Integrations">Server-side Action</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#client-side-integration" class="toc-h3 toc-link" data-title="Integrations">Client-side Integration</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#stripe-integration" class="toc-h2 toc-link" data-title="Integrations">Stripe Integration</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#why-use-a-vendor" class="toc-h3 toc-link" data-title="Integrations">Why use a vendor?</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#server-side-action-2" class="toc-h3 toc-link" data-title="Integrations">Server-side Action</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#client-side-integration-2" class="toc-h3 toc-link" data-title="Integrations">Client-side Integration</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#conclusion" class="toc-h3 toc-link" data-title="Integrations">Conclusion</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#mandrill" class="toc-h2 toc-link" data-title="Integrations">Mandrill</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#send-email-with-mandrill-api-no-attachment" class="toc-h3 toc-link" data-title="Integrations">Send Email with Mandrill API (No Attachment)</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#send-email-with-mandrill-api-with-attachments" class="toc-h3 toc-link" data-title="Integrations">Send Email with Mandrill API (with Attachments)</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#getting-started-in-backand" class="toc-h3 toc-link" data-title="Integrations">Getting Started in Backand</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#initializing-the-mandrill-action" class="toc-h3 toc-link" data-title="Integrations">Initializing the Mandrill Action</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#updating-the-code" class="toc-h3 toc-link" data-title="Integrations">Updating the Code</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#configuring-the-code" class="toc-h3 toc-link" data-title="Integrations">Configuring the Code</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#testing-and-deployment" class="toc-h3 toc-link" data-title="Integrations">Testing and Deployment</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#calling-the-action" class="toc-h3 toc-link" data-title="Integrations">Calling the Action</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#mailgun" class="toc-h2 toc-link" data-title="Integrations">Mailgun</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#send-email-with-mailgun-api" class="toc-h3 toc-link" data-title="Integrations">Send Email with Mailgun API</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#sendgrid" class="toc-h2 toc-link" data-title="Integrations">SendGrid</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#who-is-sendgrid-for" class="toc-h3 toc-link" data-title="Integrations">Who is SendGrid for?</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#send-email-with-sendgrid-api" class="toc-h3 toc-link" data-title="Integrations">Send Email with SendGrid API</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#paypal" class="toc-h2 toc-link" data-title="Integrations">PayPal</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#server-side-action-3" class="toc-h3 toc-link" data-title="Integrations">Server-side Action</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#client-side-integration-3" class="toc-h3 toc-link" data-title="Integrations">Client-side Integration</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#conclusion-2" class="toc-h3 toc-link" data-title="Integrations">Conclusion</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#segment-io" class="toc-h2 toc-link" data-title="Integrations">Segment.io</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#server-side-action-4" class="toc-h3 toc-link" data-title="Integrations">Server-side Action</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#client-side-integration-4" class="toc-h3 toc-link" data-title="Integrations">Client-side Integration</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#twilio" class="toc-h2 toc-link" data-title="Integrations">Twilio</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#who-is-twilio-for" class="toc-h3 toc-link" data-title="Integrations">Who is Twilio for?</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#send-sms-with-twilio-api" class="toc-h3 toc-link" data-title="Integrations">Send SMS with Twilio API</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#setup-a-free-account-in-twilio" class="toc-h3 toc-link" data-title="Integrations">Setup a FREE account in Twilio</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#setup-client-side-code" class="toc-h3 toc-link" data-title="Integrations">Setup client-side code:</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#netmera" class="toc-h2 toc-link" data-title="Integrations">Netmera</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-started-with-netmera" class="toc-h3 toc-link" data-title="Integrations">Get Started with Netmera</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#integrating-netmera-with-backand" class="toc-h3 toc-link" data-title="Integrations">Integrating Netmera with Backand</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#pushwoosh" class="toc-h2 toc-link" data-title="Integrations">PushWoosh</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#get-started-with-pushwoosh" class="toc-h3 toc-link" data-title="Integrations">Get Started with PushWoosh</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#integrating-pushwoosh-with-backand" class="toc-h3 toc-link" data-title="Integrations">Integrating PushWoosh with Backand</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#facebook-messenger-bot" class="toc-h2 toc-link" data-title="Integrations">Facebook Messenger Bot</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#demo" class="toc-h3 toc-link" data-title="Integrations">Demo</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#getting-started" class="toc-h3 toc-link" data-title="Integrations">Getting Started</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#em-building-the-server-em" class="toc-h3 toc-link" data-title="Integrations"><em>Building the server</em></a>
                            <!-- Nest 4 levels -->
                              <ul class="toc-list-h4">
                                  <li>
                                    <a href="#em-create-a-facebook-app-and-page-em" class="toc-h4 toc-link" data-title="Integrations"><em>Create a Facebook App and Page</em></a>
                                    <!-- Nest 5 levels -->
                                      <ul class="toc-list-h5">
                                          <li>
                                            <a href="#facebook-app-creation" class="toc-h5 toc-link" data-title="Integrations">Facebook App Creation</a>
                                          </li>
                                          <li>
                                            <a href="#em-setup-webhooks-em" class="toc-h5 toc-link" data-title="Integrations"><em>Setup Webhooks</em></a>
                                          </li>
                                          <li>
                                            <a href="#em-get-a-page-access-token-em" class="toc-h5 toc-link" data-title="Integrations"><em>Get a Page Access Token</em></a>
                                          </li>
                                          <li>
                                            <a href="#em-subscribe-the-app-to-the-page-em" class="toc-h5 toc-link" data-title="Integrations"><em>Subscribe the App to the Page</em></a>
                                          </li>
                                      </ul>
                                  </li>
                                  <li>
                                    <a href="#em-run-the-bot-em" class="toc-h4 toc-link" data-title="Integrations"><em>Run the Bot</em></a>
                                    <!-- Nest 5 levels -->
                                  </li>
                              </ul>
                          </li>
                          <li>
                            <a href="#how-to-share-your-bot" class="toc-h3 toc-link" data-title="Integrations">How to share your bot</a>
                            <!-- Nest 4 levels -->
                              <ul class="toc-list-h4">
                                  <li>
                                    <a href="#em-add-a-chat-button-to-your-webpage-em" class="toc-h4 toc-link" data-title="Integrations"><em>Add a chat button to your webpage</em></a>
                                    <!-- Nest 5 levels -->
                                      <ul class="toc-list-h5">
                                          <li>
                                            <a href="#em-create-a-shortlink-em" class="toc-h5 toc-link" data-title="Integrations"><em>Create a shortlink</em></a>
                                          </li>
                                      </ul>
                                  </li>
                                  <li>
                                    <a href="#what-39-s-next" class="toc-h4 toc-link" data-title="Integrations">What's next?</a>
                                    <!-- Nest 5 levels -->
                                  </li>
                              </ul>
                          </li>
                          <li>
                            <a href="#customizing-the-bot-39-s-code-to-em-receive-messages-em" class="toc-h3 toc-link" data-title="Integrations">Customizing the Bot's Code to <em>Receive Messages</em></a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#customizing-the-bot-39-s-code-to-em-send-a-text-message-em" class="toc-h3 toc-link" data-title="Integrations">Customizing the Bot's Code to <em>Send a Text Message</em></a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#customizing-the-bot-39-s-code-to-em-send-a-structured-message-em" class="toc-h3 toc-link" data-title="Integrations">Customizing the Bot's Code to <em>Send a Structured Message</em></a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#customizing-the-bot-39-s-code-to-em-handle-postbacks-em" class="toc-h3 toc-link" data-title="Integrations">Customizing the Bot's Code to <em>Handle Postbacks</em></a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#salesforceiq" class="toc-h2 toc-link" data-title="Integrations">SalesforceIQ</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#what-is-salesforceiq" class="toc-h3 toc-link" data-title="Integrations">What is SalesforceIQ?</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#connecting-a-backand-application-with-salesforceiq" class="toc-h3 toc-link" data-title="Integrations">Connecting a Backand application with SalesforceIQ</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#the-salesforceiq-action-template" class="toc-h3 toc-link" data-title="Integrations">The SalesforceIQ Action Template</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#connecting-this-action-to-your-salesforceiq-account" class="toc-h3 toc-link" data-title="Integrations">Connecting this action to your SalesforceIQ account</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#setup-client-side-code-2" class="toc-h3 toc-link" data-title="Integrations">Setup client-side code:</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#salesforce-crm" class="toc-h2 toc-link" data-title="Integrations">Salesforce CRM</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#what-is-salesforce-crm" class="toc-h3 toc-link" data-title="Integrations">What is Salesforce CRM?</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#connecting-a-backand-application-with-salesforce-crm" class="toc-h3 toc-link" data-title="Integrations">Connecting a Backand application with Salesforce CRM</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#the-salesforce-crm-action-template" class="toc-h3 toc-link" data-title="Integrations">The Salesforce CRM Action Template</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#setup-access-and-get-client-and-secret-keys" class="toc-h3 toc-link" data-title="Integrations">Setup access and get client and secret keys</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#setup-client-side-code-3" class="toc-h3 toc-link" data-title="Integrations">Setup client-side code:</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#calling-backand-from-native-android-code" class="toc-h2 toc-link" data-title="Integrations">Calling Backand from Native Android Code</a>
                      <ul class="toc-list-h3">
                          <li>
                            <a href="#configuring-the-connection" class="toc-h3 toc-link" data-title="Integrations">Configuring the Connection</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#authenticating" class="toc-h3 toc-link" data-title="Integrations">Authenticating</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#sending-the-request" class="toc-h3 toc-link" data-title="Integrations">Sending the Request</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#handling-the-response" class="toc-h3 toc-link" data-title="Integrations">Handling the Response</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#adding-new-functionality" class="toc-h3 toc-link" data-title="Integrations">Adding New Functionality</a>
                            <!-- Nest 4 levels -->
                          </li>
                          <li>
                            <a href="#conclusion-3" class="toc-h3 toc-link" data-title="Integrations">Conclusion</a>
                            <!-- Nest 4 levels -->
                          </li>
                      </ul>
                  </li>
                  <li>
                    <a href="#calling-backand-from-native-ios-code" class="toc-h2 toc-link" data-title="Integrations">Calling Backand from Native iOS Code</a>
                  </li>
              </ul>
          </li>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='integrations'>Integrations</h1>
<p>The following set of documentation looks at integrating Backand with a number of different types of providers. Also included are some simple Backand-powered applications that can be used either as a starting point for your development, or as a guide for integrating Backand into a larger application.</p>
<h2 id='todo-app-with-users'>ToDo App with users</h2>
<p>Recently, we released a tutorial on the <a href="https://github.com/backand/angular-yeoman-todos/tree/todo-with-users">Backand GitHub page</a> that shows off a lot of the features available by default in a Backand-powered application. After completing the tutorial, you&#39;ll have a simple ToDo list application with full support for user and role-based security. Below we&#39;ll discuss each of the features demonstrated in the tutorial, and cover any items remaining that are necessary for a full deployment.</p>
<h3 id='restful-api-out-of-the-box'>RESTful API Out-of-the-Box</h3>
<p>One of the first things we do in the tutorial, after actually creating the application with Backand, is create a new database using our JSON-based schema language. This powerful tool allows you to quickly build a database and the associated tables and objects without having a client installed. More importantly, once the database has been created, Backand automatically creates a RESTful API based on your underlying database schema. This allows you to have immediate access to your database via a series of REST API calls that create, retrieve, update, and delete records at whim. With some simple JavaScript, you can quickly build out a data layer that would take months in a stand-alone project! Furthermore, the moment you make a change to your schema, Backand will detect the change and update the API endpoints accordingly. This automated updating greatly eases the process of migrating database schema changes, and takes some of the load of server programming off your shoulders, allowing you to focus on your application&#39;s functionality.</p>
<h3 id='security-roles'>Security Roles</h3>
<p>While the RESTful API is indeed a powerful tool, the main goal of this tutorial is to explore user- and role-based security. Through Backand&#39;s dashboard you are granted a powerful array of tools that you can leverage to secure your underlying application. You can assign user-specific security settings for each object in your app, including everything from table update calls to custom triggers and actions.</p>

<p>However, doing this for every user that signs up for your application would be incredibly tedious. Luckily, Backand provides User Roles that you can assign to the users in your application. Roles set a basic template for interacting with your application&#39;s API, allowing you to restrict all users with that role to only specific actions in your application. These roles can also be overridden at an endpoint level, allowing you to grant roles specific access to resources while still maintaining their general security profile.</p>

<p>After the tutorial has been completed, you will have three roles for your users – administrators who have full control, users who can view all records in the application (but only update or delete those that they create themselves), and read-only users that are only able to view the ToDo items in your application.</p>
<h3 id='login-and-anonymous-access'>Login and Anonymous Access</h3>
<p>In addition to security roles, this tutorial will introduce you to the user access functionality available in Backand. You&#39;ll implement a mechanism for inviting users to register for your application, and enable two-step verification for your application&#39;s users, and all of the complexity will be managed by Backand! Furthermore, you&#39;ll learn how to enable anonymous access to your application through a few simple administrative dashboard settings. After the tutorial has been completed, you will have a fully secure application that allows you to invite users to the system, automatically assign them a security role, and even enable anonymous access to your ToDo list should you wish to do so.</p>
<h3 id='remaining-items'>Remaining Items</h3>
<p>While the tutorial will walk you through the entire application – from inception to completion – there will still be a few tasks remaining before you can show off your new Backand-powered ToDo list app. The first section of the tutorial focuses on setting up a local application development environment, which allows you to develop and run the code on your local machine. However, once you&#39;ve implemented the code and are ready to show it off, you still need to track down a web server to use for deployment. Luckily this web server does not need to be particularly robust, as your application requires zero server-side customization – simply deploy the application code to a publicly-accessible folder and you are set!</p>

<p>Once you&#39;ve published your application on a web server, you have a few more steps remaining in order to fully deploy the application. As a part of the tutorial you set several internal sign-up and authentication URLs that point at your local development instance. Obviously these will no longer function once you have deployed the code! Simply change the appropriate user security settings in your application&#39;s Backand dashboard, and your application will be ready to show the world!</p>
<h3 id='summary'>Summary</h3>
<p>This tutorial gives you a quick look at the power offered by Backand&#39;s back end tools and APIs. You&#39;ll explore creating a database and implementing a RESTful API for that data with zero effort. You&#39;ll customize your application&#39;s security and learn how to restrict users based on role and based on endpoint. You&#39;ll even spend some time working with custom server-side actions that execute on-demand. By the time you have finished the tutorial, you will have implemented a secure ToDo list application with user authentication – and all with minimal effort!</p>
<h2 id='ionic-with-backand'>Ionic With Backand</h2>
<p>Today many AngularJS developers are using Ionic to build the user interface for their mobile apps.  AngularJS provides the app structure.  But these mobile apps still need a backend.  In this section we’ll give you the recipe you need to build an Ionic mobile app with Backand’s Backend as a Service (BaaS). Review the working demo <a href="https://github.com/backand/simple-rest-ionic">here</a>.</p>
<h3 id='what-is-ionic'>What is Ionic?</h3>
<p>The <a href="http://ionicframework.com/">Ionic</a> framework is a mobile programming framework for constructing hybrid mobile apps. Hybrid mobile apps use a web technology (HTML, JS, CSS) to build cross-platform mobile apps (iOS, Android).  Ionic is built on top of the <a href="https://cordova.apache.org/">Cordova</a> hybrid app technology.</p>

<p>The major advantage of using Ionic over Cordova itself or its commercial version <a href="http://phonegap.com/">PhoneGap</a> is that it provides a plethora of mobile user interface templates both for the entire structure of the app (side menu, tabs) and for common parts (navigation top bar).</p>

<p>Ionic is built using the well known <a href="https://angularjs.org/">AngularJS</a> web MVC framework.  Hence, developing Ionic apps is done at a higher level of abstraction than using plain HTML and jQuery. To facilitate working with the mobile device APIs in the AngularJS way, Ionic developed <a href="http://ngcordova.com/">ngCordova</a>, a set of AngularJS components for interacting with the various mobile device capabilities (like taking pictures).  Ionic also provides a set of convenient command line tools for building and running apps.</p>
<h3 id='the-perfect-recipe-for-building-mobile-apps'>The Perfect Recipe for Building Mobile Apps</h3>
<p>In this scenario we’ll provide you with the recipe you need to use the Ionic template for a mobile app with a side menu.</p>
<h4 id='backand'>Backand</h4>
<p>Create an app in Backand using the free database feature. For this example we will demonstrate simple ‘playlists’ app
 with 3 objects: users, playlists and songs.
You can use the following JSON mode:</p>
<pre class="highlight json tab-json--persistent"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"users"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"is_approved"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"boolean"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"list"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"collection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"playlists"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"via"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"playlists"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"users"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"songs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"collection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"songs"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"via"</span><span class="p">:</span><span class="w"> </span><span class="s2">"playlist"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"songs"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"order_date"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datetime"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"playlist"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"playlists"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre><h4 id='ionic'>Ionic</h4>
<p>Now create your mobile app, naming it ‘PlaylistsApp’, with the Ionic command-line tools.</p>
<h4 id='js-libraries'>JS Libraries</h4>
<p>Your Ionic app has a <code>www</code> folder which is a single page application (SPA) built with AngularJS.  You will need to include the Backand libraries in your application. Either download them or use bower to obtain them. Then, copy them into your <code>index.html</code>.</p>

<ul>
<li><a href="https://github.com/backand/angular1-sdk">angular1-sdk</a>, install with bower using:</li>
</ul>
<pre class="highlight shell"><code>    bower install angular1-sdk
</code></pre>
<ul>
<li>Include in your <code>index.html</code>:</li>
</ul>
<pre class="highlight html tab-html"><code>     <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"lib/angularbknd-sdk/dist/backand.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
     <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"lib/angular-cookies/angular-cookies.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre><h4 id='authorization'>Authorization</h4>
<p>Backand uses authorization headers in HTTP requests. The token for authorization is obtained upon sign in to Backand and is then stored using cookies via <code>ngCookies</code>. The Backand SDK adds authorization headers to each HTTP request using an <code>$http</code> interceptor.</p>

<p>In your main JavaScript file, <code>app.js</code> requires <code>backand</code>:</p>
<pre class="highlight javascript tab-javascript"><code>     <span class="kd">var</span> <span class="nx">myApp</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'starter'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'ionic'</span><span class="p">,</span>
       <span class="s1">'starter.controllers'</span><span class="p">,</span> <span class="s1">'backand'</span><span class="p">,</span> <span class="s1">'starter.services'</span><span class="p">]);</span>
</code></pre>
<p>And in your app&#39;s <code>config</code> add:</p>
<pre class="highlight javascript tab-javascript"><code>     <span class="nx">myApp</span><span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$stateProvider</span><span class="p">,</span> <span class="nx">$urlRouterProvider</span><span class="p">,</span>
       <span class="nx">$httpProvider</span><span class="p">)</span>    <span class="p">{</span>
        <span class="nx">$httpProvider</span><span class="p">.</span><span class="nx">interceptors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">httpInterceptor</span><span class="p">);</span>
     <span class="p">});</span>
</code></pre>
<p>Defining the interceptor as:
<code>javascript
     function httpInterceptor($q, $log, $cookieStore) {
       return {
         request: function(config) {
           config.headers[&#39;Authorization&#39;] =
             $cookieStore.get(&#39;backand_token&#39;);
           return config;
         }
       };
     }
</code></p>
<h4 id='sign-in'>Sign In</h4>
<p>In your controllers module require <code>Backand</code> and <code>ngCookies</code>:</p>
<pre class="highlight javascript tab-javascript"><code>    <span class="kd">var</span> <span class="nx">myModule</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'starter.controllers'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'backand'</span><span class="p">,</span> <span class="s1">'ngCookies'</span><span class="p">]);</span>
</code></pre>
<p>In your login controller require <code>Backand</code>:</p>
<pre class="highlight javascript tab-javascript"><code>    <span class="nx">myModule</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">'loginCtrl'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">Backand</span><span class="p">)</span> <span class="p">{});</span>
</code></pre>
<p>To perform the login call, remember that <code>playlists</code> is our Backand database name:</p>
<pre class="highlight javascript tab-javascript"><code>    <span class="kd">var</span> <span class="nx">appName</span> <span class="o">=</span> <span class="s1">'playlists'</span><span class="p">;</span>
    <span class="nx">Backand</span><span class="p">.</span><span class="nx">signin</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">,</span> <span class="nx">appName</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
      <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">){});</span>
</code></pre><h4 id='crud'>CRUD</h4>
<p>Now you will need to define a service to make the database operations.  In your services module require <code>backand</code>:</p>
<pre class="highlight javascript tab-javascript"><code>    <span class="kd">var</span> <span class="nx">myServices</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'starter.services'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'backand'</span><span class="p">])</span>
</code></pre>
<p>Define a <code>DatabaseService</code>, require <code>Backand</code>:</p>
<pre class="highlight javascript tab-javascript"><code>    <span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">'DatabaseService'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$http</span><span class="p">,</span> <span class="nx">Backand</span><span class="p">){</span>    

      <span class="kd">var</span> <span class="nx">baseUrl</span> <span class="o">=</span> <span class="s1">'/1/object/data/'</span><span class="p">;</span>

      <span class="k">return</span> <span class="p">{</span>

        <span class="c1">// read all rows in the object</span>
          <span class="na">readAll</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">objectName</span><span class="p">)</span> <span class="p">{</span>  
            <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
              <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
              <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="nx">baseUrl</span> <span class="o">+</span> <span class="nx">objectName</span>
           <span class="p">}).</span><span class="nx">then</span><span class="p">(</span>
          <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
            <span class="p">});</span>
          <span class="p">},</span>

        <span class="c1">// read one row with given id</span>
          <span class="na">readOne</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">objectName</span><span class="p">,</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
            <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
            <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="nx">baseUrl</span> <span class="o">+</span> <span class="nx">self</span><span class="p">.</span><span class="nx">objectName</span>
                <span class="o">+</span> <span class="s1">'/'</span> <span class="o">+</span> <span class="nx">id</span>
          <span class="p">}).</span><span class="nx">then</span><span class="p">(</span>
            <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
            <span class="p">});</span>
          <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">});</span>
</code></pre><h4 id='using-backand-data'>Using Backand Data</h4>
<p>In your controller, require <code>DatabaseService</code>, and make calls like:</p>
<pre class="highlight javascript tab-javascript"><code>    <span class="nx">myModule</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">'playlistsCtrl'</span><span class="p">,</span>    
      <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">DatabaseService</span><span class="p">)</span> <span class="p">{</span>

      <span class="nx">$scope</span><span class="p">.</span><span class="nx">playlists</span> <span class="o">=</span> <span class="p">[];</span>

      <span class="c1">// read all playlists for a user</span>
      <span class="nx">DatabaseService</span><span class="p">.</span><span class="nx">readAll</span><span class="p">(</span><span class="s1">'playlists'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
        <span class="nx">$scope</span><span class="p">.</span><span class="nx">playlists</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
      <span class="p">});</span>

      <span class="c1">// a click handler for selecting a playlist</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">clickPlaylist</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">){</span>
                <span class="nx">DatabaseService</span><span class="p">.</span><span class="nx">readOne</span><span class="p">(</span><span class="s1">'playlists'</span><span class="p">,</span> <span class="nx">id</span><span class="p">).</span>
           <span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){});</span>
      <span class="p">});</span>

    <span class="p">});</span>
</code></pre>
<p>Now you can add more Tables and build more views by repeating the above steps. You can also add server side code or send emails in the Backand cloud service under the Action tab.</p>

<p>To review in Github: <a href="https://github.com/backand/simple-rest-ionic">ionic demo</a>.</p>
<h2 id='retrieving-data-from-facebook-using-the-graph-api'>Retrieving data from Facebook using the Graph API</h2>
<p>Once you&#39;ve integrated with Facebook, you can use Facebook&#39;s <a href="https://developers.facebook.com/docs/graph-api">Graph API</a> to augment your user data with information directly from the user&#39;s Facebook account. To do so, you&#39;ll just need to grab the user&#39;s Facebook User ID, and use the Graph API to retrieve data, update or publish new content, or any of the other functionality Facebook has to offer.</p>
<h3 id='obtaining-the-facebook-user-id'>Obtaining the Facebook User ID</h3>
<p>To store the user&#39;s Facebook user ID (FUID) in Backand, follow these steps:</p>

<ol>
<li>Open <strong>Security --&gt; Security Actions</strong> menu and edit the <strong>&quot;beforeSocialSignup&quot;</strong> action</li>
<li>Change the <strong>Where Condition</strong> of this action to &quot;true&quot; (this is set at the bottom of the content pane)</li>
<li>Uncomment the provided code that saves the Facebook user id: <code>userInput.fuid = parameters.socialProfile.additionalValues.id;</code></li>
<li>Save the Action</li>
</ol>

<p>Next, you need to add the FUID field to the &quot;users&quot; object:</p>

<ol>
<li>Open the model page, from the <strong>Objects</strong> menu</li>
<li>Edit the model to add a new field - <strong>fuid</strong>, type string - to the &quot;users&quot; object</li>
<li>Click <strong>Validate &amp; Update</strong> to validate the model, then <strong>Ok</strong> in the confirmation dialog to save your changes.</li>
</ol>

<p>From this point onward, any user that signs up to your app using Facebook as their social media provider will have their FUID automatically populated in the <strong>users</strong> object.</p>
<h3 id='obtaining-the-facebook-access-token'>Obtaining the Facebook Access token</h3>
<blockquote>
<p>Modify the security action &quot;socialAuthOverride&quot; to return &quot;Allow&quot;</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code>  <span class="k">return</span> <span class="p">{</span> <span class="s2">"result"</span><span class="p">:</span> <span class="s2">"allow"</span><span class="p">,</span> <span class="s2">"message"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">"additionalTokenInfo"</span><span class="p">:</span> <span class="nx">additionalTokenInfo</span> <span class="p">};</span>
</code></pre>
<blockquote>
<p>Now, Backand returns the Facebook access token from getUserDetails, under data.providerAccessToken</p>
</blockquote>
<pre class="highlight json tab-json--persistent"><code><span class="p">{</span><span class="w">
  </span><span class="err">...</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="s2">"providerAccessToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EAAWqshXVWMMBANSpEtxBuvGTucyOoiCYIbrNNuQnULqZAJqvNpBKJTZBV660NGQ6Ge6ZA0X0kr3mGEMpvqUX4vldM7n2iatOTZB8JjoinqaIfZCT9Lz8uAlt6LBZBqxAmmxTYLRFLgktVFzYhSxuCtzYc4COyG6DMZD"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Once you&#39;ve authenticated with Facebook, you can easily record your user&#39;s Facebook access token. This can be used to re-authenticate the user with Facebook when performing API calls, such as fetching additional user data using the Facebook Graph API.</p>
<h3 id='getting-facebook-data-into-backand-code'>Getting Facebook data into Backand code</h3><pre class="highlight javascript tab-javascript--persistent"><code>    <span class="kd">var</span> <span class="nx">fuid</span> <span class="o">=</span> <span class="s2">"176102422846507"</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">facebookAccessToken</span> <span class="o">=</span> <span class="s2">"EAAWouLyM4lEBADjVlK9yslq9YNjx7S5UUx9oKUo6BWxsj9qc77ZCuKZAPvBQUIulpieNJIJ0Uit3K0UFR0oxjxl68DupTb0uoJFXPQFUdTOlneLEprG6b8WxuYN3AX6m05hKpFbBPKczCab1OUetevdvkZCO6rtPUQEUtc68gZDZD"</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span><span class="s2">"https://graph.facebook.com/v2.8/"</span> <span class="o">+</span> <span class="nx">fuid</span> <span class="o">+</span> <span class="s2">"/friends?fields=id,name,gender"</span><span class="p">,</span>
        <span class="na">params</span><span class="p">:{</span>
            <span class="s2">"access_token"</span><span class="p">:</span> <span class="nx">facebookAccessToken</span>
        <span class="p">},</span>
        <span class="na">headers</span><span class="p">:{</span><span class="s2">"Content-Type"</span><span class="p">:</span><span class="s2">"application/json"</span><span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
</code></pre>
<p>Once you have the Facebook user ID and access token, you can use the Graph API to access any available Facebook data.</p>

<ul>
<li>See the Facebook Graph API docs at <a href="https://developers.facebook.com/docs/graph-api">https://developers.facebook.com/docs/graph-api</a></li>
<li>You&#39;ll also need a valid Facebook Access Token for your application. See the <a href="#obtaining-the-facebook-access-token">section above</a>, or use <a href="https://developers.facebook.com/tools/accesstoken/">Facebook&#39;s access token tool</a> to obtain one.</li>
<li>Facebook offers <a href="https://developers.facebook.com/tools-and-support/">additional tools</a></li>
</ul>

<p>At this point, you&#39;re ready to work with the API. For example, you can use this sample code to get a list of a user&#39;s friends in Facebook:</p>
<h3 id='getting-a-facebook-profile-image'>Getting a Facebook profile image</h3><pre class="highlight html tab-html"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>http://graph.facebook.com/{fuid}/picture<span class="nt">&lt;/a&gt;</span>
</code></pre>
<p>You can easily obtain a user&#39;s Facebook profile using a single URL reference. The template is available on the right - simply replace <strong>{fuid}</strong> with the user&#39;s Facebook User ID.</p>
<pre class="highlight html tab-html"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://graph.facebook.com/{fuid}/picture?type=large"</span> <span class="na">target=</span><span class="s">"_blank"</span><span class="nt">&gt;</span>http://graph.facebook
.com/{fuid}/picture?type=large<span class="nt">&lt;/a&gt;</span>
</code></pre>
<p>You can pull in a larger version of the profile picture using the HTML to the right:</p>

<p>Finally, you can refer to <a href="https://developers.facebook.com/docs/graph-api/reference/user/picture/">Facebook&#39;s Docs</a> on their Graph API, and use the information to create whatever type of integration with Facebook that you desire.</p>
<h2 id='amazon-aws-and-s3-integrations'>Amazon AWS and S3 Integrations</h2>
<p>Amazon Web Services, or AWS, offer a lot of useful functionality for web developers. From hosting, to distributed computing, to even simple data storage, Amazon has backed many of the web&#39;s largest websites since its inception. Below we&#39;ll look at Amazon S3, and how we can integrate the data storage service into a Backand-powered application.</p>
<h3 id='a-quick-s3-overview'>A Quick S3 Overview</h3>
<p>Amazon&#39;s Simple Storage Service, or S3, is an online file storage web service offered as a part of the Amazon Web Services suite of functionality. It was first launched in the US in 2006, and uses standard web service interfaces for communication. Service consumers can simply authorize their app with S3, then perform a series of web service calls to manage their S3 storage bucket. By using this service, a developer can offload concerns about data availability, reliability, and storage space to Amazon&#39;s server farms, simply paying a usage-based fee each month for the data stored.</p>
<h3 id='server-side-action'>Server-side Action</h3>
<p><a href="https://github.com/backand/simple-noterious-app">Backand&#39;s Noterious app</a> has an excellent example of how simple an integration with S3 can be. The functionality revolves around the creation of server-side actions to wrap the web service requests made over HTTP. The actual integration looks like this:</p>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span>
    <span class="p">{</span>
        <span class="c1">// enter your aws key</span>
        <span class="s2">"key"</span> <span class="p">:</span> <span class="s2">"AKIAIJX26SY3COIWV4FQ"</span><span class="p">,</span>

        <span class="c1">// enter your aws secret key</span>
        <span class="s2">"secret"</span> <span class="p">:</span> <span class="s2">"ogun3pSOyw8FtP5i17s2STBPO9jQ8cs+lnpxwg82"</span><span class="p">,</span>

        <span class="c1">// this should be sent in post body</span>
        <span class="s2">"filename"</span> <span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">filename</span><span class="p">,</span>
        <span class="s2">"filedata"</span> <span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">filedata</span><span class="p">,</span>         

        <span class="s2">"region"</span> <span class="p">:</span> <span class="s2">"US Standard"</span><span class="p">,</span>
        <span class="s2">"bucket"</span> <span class="p">:</span> <span class="s2">"backand-free-upload"</span>

    <span class="p">}</span>
<span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span><span class="na">method</span><span class="p">:</span><span class="s2">"PUT"</span><span class="p">,</span><span class="na">url</span><span class="p">:</span><span class="nx">CONSTS</span><span class="p">.</span><span class="nx">apiUrl</span> <span class="o">+</span> <span class="s2">"/1/file/s3"</span> <span class="p">,</span>
               <span class="na">data</span><span class="p">:</span> <span class="nx">data</span><span class="p">,</span> <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s2">"Authorization"</span><span class="p">:</span><span class="nx">userProfile</span><span class="p">.</span><span class="nx">token</span><span class="p">}});</span>

<span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
</code></pre>
<p>The above code is inserted into a new Custom Server-Side JavaScript Action created using the Backand dashboard. It pulls the file information from the parameters passed to the action, then sends a request to S3&#39;s file upload endpoint, putting the file into the bucket <code>backand-free-upload</code>. By customizing the above code, you can achieve any underlying file structure you desire.</p>
<h3 id='client-side-integration'>Client-side Integration</h3>
<p>Of course the server-side code is only half of the story – we need to integrate this wrapped API call into our application for it to be useful. Going back to the Noterious demo application, you can see an example of this taking place in the <a href="https://github.com/backand/simple-noterious-app/blob/6da40ba8b235c35d77f1845a643e80a352d1dc20/src/app/common/models/notes-model.js#L44">Notes model class</a>:</p>
<pre class="highlight javascript tab-javascript"><code><span class="c1">//Send file content in base64 to Backand on-demand action</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">s3FileUpload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span> <span class="nx">filedata</span><span class="p">,</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
    <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/notes?name=upload2s3'</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span>
    <span class="p">},</span>
    <span class="na">data</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">"filename"</span><span class="p">:</span><span class="nx">filename</span><span class="p">,</span>
      <span class="s2">"filedata"</span><span class="p">:</span> <span class="nx">filedata</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">filedata</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">filedata</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="c1">//need to remove the file prefix type</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre>
<p>The above code is pretty straightforward. It defines a function – <code>s3FileUpload</code> – that takes input from your application in the form of file data, and then communicates with your new custom JavaScript action via an HTTP POST request using JavaScript&#39;s built-in AJAX capabilities. Simply call this function from your Angular code, and you will be uploading files in no time!</p>
<h2 id='stripe-integration'>Stripe Integration</h2>
<p>Once you&#39;ve decided how you want to monetize your web app, you&#39;ll likely begin looking at ways to integrate your code with a vendor that will accept and process payments on your behalf. While this would be a daunting effort to perform in a custom-built environment, Backand&#39;s built-in security and stability help to ease many of the requirements that are imposed upon payment applications. Below we&#39;ll look at using a third-party vendor – <a href="http://www.stripe.com/">Stripe</a> – to process payments, and examine how to integrate Stripe with a Backand application.</p>

<p>A quick note: In our <a href="https://github.com/backand/stripe-example">Stripe Example Application</a>, we used <a href="https://github.com/bendrucker/angular-stripe">angular-stripe</a> – a popular third-party tool that allows you to easily interface with Stripe from your Angular code – to make calls to Stripe&#39;s Stripe.js file, which provides most of the payment tokenization functionality. This is obviously a convenience, and you are free to call Stripe.js directly from your application, but the below text assumes you are also using this library. It is also important to note that the code below – particularly the client side code – was adapted from the Stripe example application, and as such may not be directly usable without some modification. Please study the code to understand the content, rather than simply trying to cut-and-paste the client-side components.</p>
<h3 id='why-use-a-vendor'>Why use a vendor?</h3>
<p>The first question that you are likely asking is &quot;Why should I use a third-party vendor for my payment system?&quot; The short answer, albeit not a very good one, is that a solid and reliable payments platform is not only extremely challenging, but extremely expensive as well. Setting aside the data concerns (which we have covered elsewhere), you&#39;ll need significant liquid assets available to even begin working with financial systems directly. Furthermore, you&#39;ll be accepting full fraud risk for your users – if any of your users tries to use your payments system for illegal or unethical ends, then you will be liable for the damages caused. These are just a few of the many concerns that would come with building a payment system from the ground up without using a payment vendor.</p>

<p>With a payment vendor, on the other hand, you are able to offload all of the above issues to the vendor, allowing you to focus instead on integrating payments into your application. Stripe performs underwriting (which handles any potentially fraudulent individuals by simply preventing them from accepting payments), payment processing, communication with financial systems, and all necessary reporting as the transactions move through the various banks and financial APIs. While it would be possible to perform all of this work yourself, you&#39;ll save yourself years of labor by simply leveraging someone else&#39;s efforts.</p>
<h3 id='server-side-action-2'>Server-side Action</h3>
<p>We&#39;ll begin the application by adding a custom server-side action. This action will execute JavaScript that accepts a payment token as an argument, and then uses that token to register a payment with Stripe. Simply use the following code in your server-side action to log your payment:</p>
<pre class="highlight javascript tab-javascript"><code>  <span class="c1">// Secret key - copy from your Stripe account   </span>
  <span class="c1">// - https://dashboard.stripe.com/account/apikeys -</span>
  <span class="c1">// or use Backand's test account</span>
  <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">btoa</span><span class="p">(</span><span class="s2">"sk_test_hx4i19p4CJVwJzdf7AajsbBr:"</span><span class="p">);</span>

  <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
    <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"https://api.stripe.com/v1/charges"</span><span class="p">,</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"amount"</span><span class="p">:</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span>
        <span class="s2">"currency"</span><span class="p">:</span><span class="s2">"usd"</span><span class="p">,</span>
        <span class="s2">"source"</span><span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">token</span>
    <span class="p">},</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"Authorization"</span><span class="p">:</span> <span class="s2">"Basic "</span> <span class="o">+</span> <span class="nx">user</span><span class="p">,</span>
        <span class="s2">"Accept"</span> <span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
        <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/x-www-form-urlencoded"</span>
    <span class="p">}</span>
  <span class="p">});</span>

<span class="k">return</span> <span class="p">{</span><span class="s2">"data"</span><span class="p">:</span><span class="nx">response</span><span class="p">};</span>
</code></pre>
<p>The above code simply takes all of the information needed for a payment – specifically the amount (in pennies) and the payment method token – and sends them to Stripe via a POST request to their <a href="https://stripe.com/docs/api">RESTful API</a>. You can create as many of these actions as you like, wrapping additional Stripe API calls at will.</p>
<h3 id='client-side-integration-2'>Client-side Integration</h3>
<p>Once you&#39;ve got the server-side action, you are just about ready to start accepting payments. There are two steps that need to take place on the client side before you can do so. First, we&#39;ll look at setting the API Key.</p>

<p>The API Key tells the Stripe.js file that the actions being taken are to take place under your Stripe account. On the server side, this is the Secret Key that you obtain from the Stripe dashboard. The client side needs something more secure, though, as anyone with your secret key could impersonate your app and cause security issues. Recognizing this, Stripe provides you with a public key that you can use for client-side code. This is secured against a secret key on your Stripe account, and cannot be used to actually register payments or perform transfers. To set your public key, use the following code:</p>
<pre class="highlight javascript tab-javascript"><code>  <span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">stripeProvider</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">//Enter your Stripe publish key or use Backand test account</span>
    <span class="nx">stripeProvider</span><span class="p">.</span><span class="nx">setPublishableKey</span><span class="p">(</span><span class="s1">'pk_test_pRcGwomWSz2kP8GI0SxLH6ay'</span><span class="p">);</span>
  <span class="p">})</span>
</code></pre>
<p>Once you&#39;ve set your publishable key, you&#39;re ready to start tokenizing payment methods. The code below performs two tasks. It first creates a token from the payment data entered into your app&#39;s UI, then it sends that token to the custom action that we created in the previous section by calling a convenience method. We&#39;ll first add the tokenization and payment success code:</p>
<pre class="highlight javascript tab-javascript"><code>  <span class="nx">self</span><span class="p">.</span><span class="nx">charge</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

    <span class="c1">//get the form's data</span>
    <span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#payment-form'</span><span class="p">))[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">//Use angular-stripe service to get the token</span>
    <span class="k">return</span> <span class="nx">stripe</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">createToken</span><span class="p">(</span><span class="nx">form</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'token created for card ending in '</span><span class="p">,</span> <span class="nx">token</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">last4</span><span class="p">);</span>

        <span class="c1">//Call Backand action to make the payment</span>
        <span class="k">return</span> <span class="nx">BackandService</span><span class="p">.</span><span class="nx">makePayment</span><span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">amount</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="nx">token</span><span class="p">.</span><span class="nx">id</span> <span class="p">)</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">payment</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="s1">'successfully submitted payment for $'</span> <span class="o">+</span> <span class="nx">payment</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">amount</span><span class="o">/</span><span class="mf">100.0</span><span class="p">;</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="sr">/^Stripe/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">type</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="s1">'Stripe error: '</span> <span class="o">+</span>  <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="s1">'Other error occurred, possibly with your API'</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
  <span class="p">}</span>
</code></pre>
<p>Once this code has been created, we need to write one additional function. This function wraps a HTTP request to the custom action we created previously. It assumes that the action&#39;s name is <code>makePayment</code>, so be sure to change it to something that matches your actual implementation:</p>
<pre class="highlight javascript tab-javascript"><code><span class="nx">factory</span><span class="p">.</span><span class="nx">makePayment</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">amount</span><span class="p">,</span> <span class="nx">token</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
      <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/items?name=makePayment'</span><span class="p">,</span>
      <span class="na">params</span><span class="p">:{</span>
        <span class="na">parameters</span><span class="p">:{</span>
          <span class="na">token</span><span class="p">:</span> <span class="nx">token</span><span class="p">,</span>
          <span class="na">amount</span><span class="p">:</span> <span class="nx">amount</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
</code></pre>
<p>And with that, we&#39;ve added the basic code necessary to contact Stripe and record a payment.</p>
<h3 id='conclusion'>Conclusion</h3>
<p>The above code gives us the basis of a payments system. It can accept payments from a user, which are recorded against your own Stripe account. You can use this as a basis for a larger application, that provides a deeper integration with Stripe&#39;s API. Simply follow the pattern of wrapping the API calls in server-side actions, then calling those actions via the Backand API, and you&#39;ll have a solution built very rapidly that is both secure and scalable from day one.</p>
<h2 id='mandrill'>Mandrill</h2>
<p>Mandrill is an email infrastructure service that focuses on transactional emails. Using Mandrill, you can send personalized e-commerce messages on a one-to-one basis, or automated transactional messages for things like password resets, order confirmations, and welcome messages.</p>
<h3 id='send-email-with-mandrill-api-no-attachment'>Send Email with Mandrill API (No Attachment)</h3>
<p>Mandrill has an API that you can use to send emails, along with a lot of other functionality. By translating their provided cURL commands to Angular $http calls, you can easily integrate Mandrill with Backand.</p>

<blockquote>
<p>Server side action code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="cm">/* globals
  $http - Service for AJAX calls
  CONSTS - CONSTS.apiUrl for Backands API URL
*/</span>
<span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">backandCallback</span><span class="p">(</span><span class="nx">userInput</span><span class="p">,</span> <span class="nx">dbRow</span><span class="p">,</span> <span class="nx">parameters</span><span class="p">,</span> <span class="nx">userProfile</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// write your code here</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
      <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'https://mandrillapp.com/api/1.0/messages/send.json'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="p">{</span><span class="s1">'key'</span><span class="p">:</span><span class="o">&lt;</span><span class="nx">enter</span> <span class="nx">your</span> <span class="nx">mandrill</span> <span class="nx">key</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="s1">'message'</span><span class="p">:{</span><span class="s1">'html'</span><span class="p">:</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
            <span class="s1">'subject'</span><span class="p">:</span><span class="s1">'Example for Mandrill Integration'</span><span class="p">,</span>
            <span class="s1">'from_email'</span><span class="p">:</span><span class="nx">userProfile</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span><span class="s1">'from_name'</span><span class="p">:</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
            <span class="s1">'to'</span><span class="p">:[{</span><span class="s1">'email'</span><span class="p">:</span><span class="nx">userProfile</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span><span class="s1">'name'</span><span class="p">:</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="s1">'type'</span><span class="p">:</span><span class="s1">'to'</span><span class="p">}],</span>
            <span class="s1">'headers'</span><span class="p">:{</span><span class="s1">'Reply-To'</span><span class="p">:</span><span class="s1">'message.reply@backand.com'</span><span class="p">}}}</span>
    <span class="p">});</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">{};</span>
<span class="p">}</span>
</code></pre>
<p>To send an email with Mandrill, you need to create a server side action. You can either trigger this action with an object&#39;s CRUD event handler, or call it on-demand from your client code. The following example demonstrates the on-demand option. In the Backand dashboard, open the Actions tab for one of your application&#39;s objects, and create a new on-demand server-side JavaScript action. Learn more about how to create actions <a href="#custom-actions">here</a>. Name the action <code>mandrillapp</code>, add <code>message</code> and <code>name</code> to the Input Parameters, and paste the code on the right into the code editor.</p>

<p>In the example app we&#39;re building, the app&#39;s users can send messages to themselves. This is done through the use of <code>userProfile.username</code>, which is the email address used to register with the application. Make sure to replace the <code>key</code> property above with your Mandrill API key.</p>

<blockquote>
<p>Client-side code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;/1'</span><span class="p">,</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'mandrillapp'</span><span class="p">,</span>
    <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">message</span><span class="p">:</span> <span class="s1">'Anything you can put your mind on'</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'&lt;your name here&gt;'</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<p>Next, add the JavaScript code to the right to your app&#39;s client-side code base. Replace <code>&lt;your object name&gt;</code> with the object associated with the action you created. Once this is done, you&#39;ll be able to easily trigger emails via Mandrill using Backand&#39;s custom action API.</p>
<h3 id='send-email-with-mandrill-api-with-attachments'>Send Email with Mandrill API (with Attachments)</h3>
<p>Below, we’ll create a server-side Node JS action that imports the Mandrill SDK, allowing you to easily send email with attachments through Mandrill in your Backand application.</p>
<h3 id='getting-started-in-backand'>Getting Started in Backand</h3>
<p>To get started with a Mandrill action, you’ll need to first create a new Server-Side NodeJS action in Backand. To do so, open up your app’s dashboard at <a href="https://www.backand.com">https://www.backand.com</a>, and navigate to an object that will host the action. On the Actions tab of this object, create a new &#39;On Demand&#39; action. Name this action, then select &#39;Server-Side Node.JS Action&#39; as the action’s type. Follow the documentation provided to download the Backand CLI and initialize your action locally.</p>
<h3 id='initializing-the-mandrill-action'>Initializing the Mandrill Action</h3>
<p>Once you have the Server-Side Node.js action ready to go, the next step is to create an action in Mandrill. Navigate to <a href="http://www.mandrill.com/">http://www.mandrill.com/</a> and create a new action in the MailChimp dashboard provided when you log in. Once the action is ready, copy down the Mandrill API Key value and save it somewhere safe. This API key will be used by the Node.js action to connect and communicate with Mandrill.</p>
<h3 id='updating-the-code'>Updating the Code</h3><pre class="highlight javascript tab-javascript--persistent"><code><span class="kd">var</span> <span class="nx">mandrill</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'node-mandrill'</span><span class="p">)(</span><span class="nx">MANDRILL_API_KEY</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'request'</span><span class="p">).</span><span class="nx">defaults</span><span class="p">({</span> <span class="na">encoding</span><span class="p">:</span> <span class="kc">null</span> <span class="p">});</span>
</code></pre>
<p>Next, we’ll need to update the action’s code to communicate with Mandrill. We’ll start by  configuring the mandrill SDK requirements in <code>index.js</code>. Add these lines into <code>index.js</code> in your Node.js action folder structure, before the function <code>exports.backandCallback</code>:</p>

<aside class="notice">Be sure to replace MANDRILL_API_KEY with the value copied down from the Mandrill dashboard.</aside>
<pre class="highlight javascript tab-javascript--persistent"><code>    <span class="kd">var</span> <span class="nx">filePath</span> <span class="o">=</span> <span class="s1">'PATH_TO_ATTACHMENT_INCLUDING_FILENAME'</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">fileName</span> <span class="o">=</span> <span class="s1">'FILENAME_OF_ATTACHMENT'</span><span class="p">;</span>

    <span class="nx">request</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">sendEmail</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s1">'content-type'</span><span class="p">],</span> <span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="nx">body</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s1">'base64'</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="kd">function</span> <span class="nx">sendEmail</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">fileType</span><span class="p">,</span> <span class="nx">fileContent</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">mandrill</span><span class="p">(</span><span class="s1">'/messages/send'</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">message</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">to</span><span class="p">:</span> <span class="p">[{</span><span class="na">email</span><span class="p">:</span> <span class="s1">'RECIPIENT_EMAIL'</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'RECIPIENT_DISPLAY_NAME'</span><span class="p">}],</span>
          <span class="na">from_email</span><span class="p">:</span> <span class="s1">'SENDER'</span><span class="p">,</span>
          <span class="na">subject</span><span class="p">:</span> <span class="s1">'EMAIL_SUBJECT'</span><span class="p">,</span>
          <span class="na">text</span><span class="p">:</span> <span class="s1">'MESSAGE_BODY'</span><span class="p">,</span>
          <span class="na">attachments</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s1">'type'</span><span class="p">:</span> <span class="nx">fileType</span><span class="p">,</span>
            <span class="s1">'name'</span><span class="p">:</span> <span class="nx">fileName</span><span class="p">,</span>
            <span class="s1">'content'</span><span class="p">:</span> <span class="nx">fileContent</span>
          <span class="p">}]</span>
        <span class="p">}</span>
      <span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//uh oh, there was an error</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">//console.log(JSON.stringify(error));</span>
          <span class="nx">response</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">//everything's good, lets see what mandrill said</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
          <span class="nx">response</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
        <span class="p">}</span>


      <span class="p">});</span>
    <span class="p">}</span>
</code></pre>
<p>Next, we’ll modify the <code>backandCallback</code> function to send a message with Mandrill. Replace the contents of this function with the code on the right. This code does two things:</p>

<ol>
<li>The initial code fetches the attachment data from the server on which it is stored. If this code succeeds, it calls <code>sendEmail</code> with the file data provided as a Base 64 string.</li>
<li><code>sendEmail</code> then takes this data and contacts Mandrill to send the message.</li>
</ol>
<h3 id='configuring-the-code'>Configuring the Code</h3>
<p>To tie the project together and finalize the above code, simply replace each of the placeholders with the appropriate value:</p>

<ul>
<li><code>PATH_TO_ATTACHMENT_INCLUDING_FILENAME</code> - this is the URL to the attachment you wish to send. If fetching this fails, sending the message will not succeed.</li>
<li><code>FILENAME_OF_ATTACHMENT</code> - this is the file name that will be given to the attachment.</li>
<li><code>RECIPIENT_EMAIL</code> - This is the email for the message’s intended recipient.</li>
<li><code>RECIPIENT_DISPLAY_NAME</code> - This is the recipient’s display name.</li>
<li><code>SENDER</code> - This is the email from which the message was sent.</li>
<li><code>EMAIL_SUBJECT</code> - This is the subject of the email.</li>
<li><code>MESSAGE_BODY</code> - This is the content of the email.</li>
</ul>

<p>You can also use the parameters argument to the action to send additional message data, whether that data originates in your app’s database or via the API call. Once these changes are made, your server-side action is ready to deploy!</p>
<h3 id='testing-and-deployment'>Testing and Deployment</h3>
<p>You can debug and run the action locally using the provided <code>debug.js</code> file. Simply enter node <code>debug.js</code> on the command line to debug. Once you’ve finished your local testing, you can then deploy the action via the documentation provided in the Server-Side Action’s UI in your app’s dashboard at Backand.com - head to the Actions tab for the relevant object, and follow the instructions on using <code>backand action deploy</code> to deploy your code.</p>
<h3 id='calling-the-action'>Calling the Action</h3>
<p>To call the action in your client-side code, simply use the Backand SDK’s action functionality as you would any other on-demand action:</p>
<pre class="highlight javascript tab-javascript"><code>  <span class="k">return</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">object</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'OBJECT_NAME'</span><span class="p">,</span> <span class="s1">'ACTION_NAME'</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">'parameters'</span><span class="p">:</span> <span class="p">{}</span>
  <span class="p">})</span>
</code></pre>
<p>Simply replace <code>OBJECT_NAME</code> with the name of the object controlling your action, and <code>ACTION_NAME</code> with the Server-Side Node.js Action’s name in Backand. You can provide any extra information or detail using the provided <code>parameters</code> object - this will be passed into the parameters argument of your action.</p>
<h2 id='mailgun'>Mailgun</h2>
<p>Mailgun is an email automation service provided by Rackspace. It offers a complete cloud-based email service for sending, receiving, and tracking email messages sent by your registered websites and applications.</p>
<h3 id='send-email-with-mailgun-api'>Send Email with Mailgun API</h3>
<blockquote>
<p>Server-side Action</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="cm">/* globals
  $http - service for AJAX calls - $http({method:"GET",url:CONSTS.apiUrl + "/1/objects/yourObject" , headers: {"Authorization":userProfile.token}});
  CONSTS - CONSTS.apiUrl for Backand's API URL
*/</span>
<span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">backandCallback</span><span class="p">(</span><span class="nx">userInput</span><span class="p">,</span> <span class="nx">dbRow</span><span class="p">,</span> <span class="nx">parameters</span><span class="p">,</span> <span class="nx">userProfile</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// write your code here</span>

    <span class="kd">var</span> <span class="nx">apiBaseUrl</span> <span class="o">=</span> <span class="s2">"https://api.mailgun.net/v3/sandbox&lt;your mailgun sandbox key here&gt;.mailgun.org/messages"</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="s2">"api:&lt;your mailgun key here&gt;"</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">encodedAuth</span> <span class="o">=</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">apiKey</span><span class="p">);</span>
    <span class="c1">//console.log(encodedAuth);</span>

        <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="na">method</span><span class="p">:</span><span class="s2">"POST"</span><span class="p">,</span>
            <span class="na">url</span><span class="p">:</span> <span class="nx">apiBaseUrl</span><span class="p">,</span>
            <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">"Authorization"</span><span class="p">:</span> <span class="s2">"Basic "</span> <span class="o">+</span> <span class="nx">encodedAuth</span><span class="p">,</span>
                <span class="s2">"Content-Type"</span> <span class="p">:</span> <span class="s2">"multipart/form-data; charset=utf-8"</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">from</span><span class="p">:</span> <span class="nx">userProfile</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
                <span class="na">to</span><span class="p">:</span> <span class="nx">userProfile</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
                <span class="na">subject</span><span class="p">:</span> <span class="s1">'testing mailgun with backand'</span><span class="p">,</span>
                <span class="na">text</span><span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">message</span>
            <span class="p">}</span>

        <span class="p">}</span>
    <span class="p">);</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">{};</span>
<span class="p">}</span>
</code></pre>
<p>Mailgun provides an API that can be used to easily send email, among many other features. By translating Mailgun&#39;s provided cURL examples to JavaScript $http calls, you can easily integrate Mailgun with Backand.</p>

<p>To send an email with Mailgun, you need to create a server side action.You can either trigger this action with an object&#39;s CRUD event handler, or call it on-demand from your client code. The following example demonstrates the on-demand option. In the Backand dashboard, open the Actions tab for one of your application&#39;s objects, and create a new on-demand server-side JavaScript action. Learn more how to create actions <a href="#custom-actions">here</a>. Name the action <code>mailgun</code>, add <code>message</code> and <code>name</code> to the Input Parameters, and paste the code on the right in the code editor. In this example the app user can send any message that he wants to himself. Please replace the &quot;apiKey&quot; property, as well as the sandbox URL, with your associated mailgun values.</p>

<blockquote>
<p>Client-side code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;/1'</span><span class="p">,</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'mailgun'</span><span class="p">,</span>
    <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">message</span><span class="p">:</span> <span class="s1">'Anything you can put your mind on'</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'&lt;your name here&gt;'</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>

</code></pre>
<p>Next, add the client-side JavaScript code to your app&#39;s code base. Replace <code>&lt;your object name&gt;</code> with the object associated with the action you created, and you are ready to send messages via Mailgun!</p>
<h2 id='sendgrid'>SendGrid</h2>
<p>SendGrid is a cloud-based SMTP provider that allows you to send email without having to maintain email servers. SendGrid manages all of the technical details, from scaling the infrastructure to ISP outreach and reputation monitoring to whitelist services and real time analytics.</p>
<h3 id='who-is-sendgrid-for'>Who is SendGrid for?</h3>
<p>SendGrid is for anyone that needs to send email, whether it’s transactional email or marketing emails and campaigns. We send billions of emails each month, so we can handle your email regardless of volume.</p>
<h3 id='send-email-with-sendgrid-api'>Send Email with SendGrid API</h3>
<blockquote>
<p>Server-Side Code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="cm">/* globals
  $http - Service for AJAX calls
  CONSTS - CONSTS.apiUrl for Backands API URL
  Config - Global Configuration
  socket - Send realtime database communication
*/</span>
<span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">backandCallback</span><span class="p">(</span><span class="nx">userInput</span><span class="p">,</span> <span class="nx">dbRow</span><span class="p">,</span> <span class="nx">parameters</span><span class="p">,</span> <span class="nx">userProfile</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span><span class="s2">"POST"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span><span class="s2">"https://api.sendgrid.com/api/mail.send.json"</span><span class="p">,</span>
        <span class="na">data</span><span class="p">:</span>
            <span class="s2">"from="</span> <span class="o">+</span><span class="nx">userProfile</span><span class="p">.</span><span class="nx">username</span><span class="o">+</span>
            <span class="s2">"&amp;to="</span> <span class="o">+</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">to</span> <span class="o">+</span>
            <span class="s2">"&amp;subject=hellow"</span><span class="o">+</span>
            <span class="s2">"&amp;html="</span> <span class="o">+</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>

         <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s2">"Accept"</span><span class="p">:</span><span class="s2">"Accept:application/json"</span><span class="p">,</span>
                <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/x-www-form-urlencoded"</span><span class="p">,</span>
                <span class="s2">"Authorization"</span><span class="p">:</span><span class="s2">"Bearer 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"</span>

         <span class="p">}</span>
     <span class="p">});</span>
     <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>SendGrid has an API that you can use to send emails, along with a lot of other functionality. By translating their provided cURL commands to Angular $http calls, you can easily integrate SendGrid with Backand.</p>

<p>To send an email with SendGrid, you need to create a server side action. You can either trigger this action with an object&#39;s CRUD event handler, or call it on-demand from your client code. The following example demonstrates the on-demand option. In the Backand dashboard, open the Actions tab for one of your application&#39;s objects, and create a new on-demand server-side JavaScript action. Learn more how to create actions <a href="#custom-actions">here</a>. Name the action <code>SendGrid</code>, add <code>to</code> and <code>message</code> to the Input Parameters (like that: to, message ), and paste the server-side code into the code editor.</p>

<p>In the example app we&#39;re building, the app&#39;s users can send messages to an email sent by the client side in the &#39;to&#39; parameter.  Make sure to replace the &#39;Authorization&#39; header above with your SendGrid API key (after you register with SendGrid you should waite for your account to be provisioned and than you&#39;ll see the API KEY under Settings/ API Keys).</p>

<blockquote>
<p>Client-Side code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;'</span><span class="p">,</span>
  <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'SendGrid'</span><span class="p">,</span>
    <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">message</span><span class="p">:</span> <span class="s1">'Anything you can put your mind on'</span><span class="p">,</span>
      <span class="na">to</span><span class="p">:</span> <span class="s1">'&lt;your destination email&gt;'</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>

</code></pre>
<p>Next, add the client-side JavaScript code to your app&#39;s code base. Replace <code>&lt;your object name&gt;</code> with the object associated with the action you created and <code>&lt;your destination email&gt;</code> with the target recipient.</p>

<p>Once this is done, you&#39;ll be able to easily trigger emails via SendGrid using Backand&#39;s custom action API.</p>
<h2 id='paypal'>PayPal</h2>
<p>Once you&#39;ve decided how you want to monetize your web app, you&#39;ll likely begin looking at ways to integrate your code with a vendor that will accept and process payments on your behalf. While this would be a daunting effort to perform in a custom-built environment, Backand&#39;s built-in security and stability help to ease many of the requirements that are imposed upon payment applications. Below we&#39;ll look at using a third-party vendor – <a href="http://www.paypal.com/">PayPal</a> – to process payments, and examine how to integrate PayPal with a Backand application.</p>

<p>A quick note: The below text was adapted from the <a href="https://developer.paypal.com/docs/integration/direct/make-your-first-call/#make-an-api-call">PayPal developer docs</a>, and as such may not be directly usable without some modification. Please study the code to understand the content, rather than simply trying to cut-and-paste the client-side components.</p>

<p>PayPal provides many options for accepting payments, including Express Checkout, transactions, refunds, payment with agreementId, and so on. In this example, we will implement Express Chackout as it is the simplest and most straightforward method to enable.</p>
<h3 id='server-side-action-3'>Server-side Action</h3>
<blockquote>
<p>Server-side Action Code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code>
   <span class="kd">var</span> <span class="nx">paypalUrl</span> <span class="o">=</span> <span class="s1">'https://api.sandbox.paypal.com/'</span><span class="p">;</span>

   <span class="c1">// PayPal has a 2 stage process where: // the first stage prepares the payment and a returns a url for the user to pay</span>
   <span class="c1">// and the sconde stage (where the payment is actually done) is where the application send an approval API call to PayPal</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">process</span> <span class="o">==</span> <span class="s1">'payment'</span><span class="p">)</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">payment</span> <span class="o">=</span> <span class="nx">postPayment</span><span class="p">();</span>
     <span class="k">return</span> <span class="nx">payment</span><span class="p">.</span><span class="nx">links</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">href</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">parameters</span><span class="p">.</span><span class="nx">process</span> <span class="o">==</span> <span class="s1">'approval'</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">postApproval</span><span class="p">();</span>
   <span class="p">}</span>

   <span class="kd">function</span> <span class="nx">postPayment</span><span class="p">()</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">authorization</span> <span class="o">=</span> <span class="s2">"Bearer "</span> <span class="o">+</span> <span class="nx">getAccessToken</span><span class="p">().</span><span class="nx">access_token</span><span class="p">;</span>
     <span class="kd">var</span> <span class="nx">payment</span> <span class="o">=</span> <span class="p">{</span>
       <span class="s2">"intent"</span><span class="p">:</span> <span class="s2">"sale"</span><span class="p">,</span>
       <span class="s2">"redirect_urls"</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">"return_url"</span><span class="p">:</span> <span class="s2">"http://localhost:3000/#/paypal"</span><span class="p">,</span>
         <span class="s2">"cancel_url"</span><span class="p">:</span> <span class="s2">"http://localhost:3000/#/paypal?fail=true"</span>
       <span class="p">},</span>
       <span class="s2">"payer"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"payment_method"</span><span class="p">:</span> <span class="s2">"paypal"</span><span class="p">},</span>
       <span class="s2">"transactions"</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">"amount"</span><span class="p">:</span> <span class="p">{</span>
             <span class="s2">"total"</span><span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span>
             <span class="s2">"currency"</span><span class="p">:</span> <span class="s2">"USD"</span>
           <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">};</span>
     <span class="k">try</span> <span class="p">{</span>
       <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
         <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
         <span class="na">url</span><span class="p">:</span> <span class="nx">paypalUrl</span> <span class="o">+</span> <span class="s1">'v1/payments/payment'</span><span class="p">,</span>
         <span class="na">data</span><span class="p">:</span> <span class="nx">payment</span><span class="p">,</span>
         <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
           <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span>
           <span class="s2">"Accept-Language"</span><span class="p">:</span> <span class="s2">"en_US"</span><span class="p">,</span>
           <span class="s2">"Authorization"</span><span class="p">:</span> <span class="nx">authorization</span>

         <span class="p">}</span>
       <span class="p">});</span>
     <span class="p">}</span>
     <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="mi">401</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">cookie</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">'paypal_token'</span><span class="p">);</span>
         <span class="k">return</span> <span class="nx">postPayment</span><span class="p">();</span>
       <span class="p">}</span>
       <span class="k">else</span> <span class="p">{</span>
         <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
       <span class="p">}</span>
     <span class="p">}</span>
   <span class="p">}</span>

   <span class="kd">function</span> <span class="nx">postApproval</span><span class="p">()</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">authorization</span> <span class="o">=</span> <span class="s2">"Bearer "</span> <span class="o">+</span> <span class="nx">getAccessToken</span><span class="p">().</span><span class="nx">access_token</span><span class="p">;</span>
     <span class="kd">var</span> <span class="nx">payer</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"payer_id"</span><span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">payerId</span><span class="p">};</span>
     <span class="k">try</span> <span class="p">{</span>
       <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
         <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
         <span class="na">url</span><span class="p">:</span> <span class="nx">paypalUrl</span> <span class="o">+</span> <span class="s1">'v1/payments/payment/'</span> <span class="o">+</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">paymentId</span> <span class="o">+</span> <span class="s1">'/execute/'</span><span class="p">,</span>
         <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">payer</span><span class="p">),</span>
         <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/json"</span><span class="p">,</span> <span class="s2">"Accept-Language"</span><span class="p">:</span> <span class="s2">"en_US"</span><span class="p">,</span> <span class="s2">"Authorization"</span><span class="p">:</span> <span class="nx">authorization</span><span class="p">}</span>
       <span class="p">});</span>
     <span class="p">}</span>
     <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="mi">401</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">cookie</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">'paypal_token'</span><span class="p">);</span>
         <span class="k">return</span> <span class="nx">postApproval</span><span class="p">();</span>
       <span class="p">}</span>
       <span class="k">else</span> <span class="p">{</span>
         <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
       <span class="p">}</span>
     <span class="p">}</span>
   <span class="p">}</span>

   <span class="kd">function</span> <span class="nx">getAccessToken</span><span class="p">()</span> <span class="p">{</span>
     <span class="kd">var</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'paypal_token'</span><span class="p">);</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">ClientId</span> <span class="o">=</span> <span class="s1">'YOUR_PayPal_CLIENT_ID'</span><span class="p">;</span>
       <span class="kd">var</span> <span class="nx">Secret</span> <span class="o">=</span> <span class="s1">'YOUR_PayPal_SECRET_KEY'</span><span class="p">;</span>
       <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">ClientId</span> <span class="o">+</span> <span class="s2">":"</span> <span class="o">+</span> <span class="nx">Secret</span><span class="p">);</span>

       <span class="k">try</span> <span class="p">{</span>
         <span class="nx">token</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">(</span>
           <span class="p">{</span>
             <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
             <span class="na">url</span><span class="p">:</span> <span class="nx">paypalUrl</span> <span class="o">+</span> <span class="s1">'v1/oauth2/token'</span><span class="p">,</span>
             <span class="na">data</span><span class="p">:</span> <span class="s1">'grant_type=client_credentials'</span><span class="p">,</span>
             <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
               <span class="s2">"Accept-Language"</span><span class="p">:</span> <span class="s2">"en_US"</span><span class="p">,</span>
               <span class="s2">"Authorization"</span><span class="p">:</span> <span class="s2">"Basic "</span> <span class="o">+</span> <span class="nx">user</span>
             <span class="p">}</span>

           <span class="p">});</span>
       <span class="p">}</span>
       <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="mi">401</span><span class="p">)</span> <span class="p">{</span>
           <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"Unauthorized (401), check client id and secret"</span><span class="p">);</span>
           <span class="nx">e</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
           <span class="k">throw</span> <span class="nx">e</span><span class="p">;</span>
         <span class="p">}</span>
         <span class="k">else</span> <span class="p">{</span>
           <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
         <span class="p">}</span>
       <span class="p">}</span>
       <span class="nx">cookie</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">'paypal_token'</span><span class="p">,</span> <span class="nx">token</span><span class="p">);</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="nx">token</span><span class="p">;</span>
   <span class="p">}</span>

</code></pre>
<p>We&#39;ll begin the application by adding a custom server-side action. This action will execute JavaScript that implements a 2 stage process. It performs the payment API call, and then the Approval API call. Each step uses an access token obtained from PayPal&#39;s OAuth2/token call. To save a call to the OAuth endpoint for an extra token, we&#39;ll cache the OAuth token in a server side cookie (although if the cookie expires, you&#39;ll need to refresh the token from the OAuth2/token endpoint. See the try-catch block). The first stage prepares the payment and returns a url for redirecting the user to PayPal site. The second stage occurs after the user has acknowledged the payment and been brought back to your application, at which point you call the Approval API to complete the payment. The code example  is a server-side action that implements all of the functionality necessary to register an Express Checkout payment with PayPal.</p>

<aside class="notice">Please note: Don't forget to change the PayPal credentials in the code below. These credentials represent your association with PayPal, and must be correct in order for your customer's funds to be correctly routed. To obtain these credentials, you can <a href="https://developer.paypal.com/developer/accounts/">create a PayPal sandbox account</a>. Note that you will first need to register for PayPal if you have not already done so.</aside>

<p>The code takes the payment stage information in <code>parameters.process</code>, and executes the appropriate PayPal API call. In the first stage, when directing the user to PayPal to confirm the payment, <code>parameters.process</code> will contain &quot;Payment&quot;. This results in the function <code>postPayment</code> being called, which sends a <code>POST</code> command to PayPal with the payment information, along with a URL to redirect to when the user either accepts or cancels the payment. In the second payment stage, when contacting the Approval API to complete the payment, <code>parameters.process</code> will contain &quot;Approval&quot;. This will result in the code calling <code>postApproval</code>, which issues a <code>POST</code> call to PayPal using the <code>PayerID</code> and <code>PaymentID</code> stored in the query string of the return URL. This function will return a PayPal payment object including all of the relevant payment details and the payment status.</p>
<h3 id='client-side-integration-3'>Client-side Integration</h3>
<blockquote>
<p>Client-side prepare payment code.</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code>      <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="nx">self</span><span class="p">.</span><span class="nx">charge</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
          <span class="nx">self</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>

          <span class="c1">//get the form's data</span>
          <span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#paypal-form'</span><span class="p">))[</span><span class="mi">0</span><span class="p">];</span>

          <span class="c1">//Call Backand action to prepare the payment</span>
          <span class="kd">var</span> <span class="nx">paypalUrl</span> <span class="o">=</span> <span class="nx">BackandService</span><span class="p">.</span><span class="nx">makePayPalPayment</span><span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">amount</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">payment</span><span class="p">)</span> <span class="p">{</span>
              <span class="kd">var</span> <span class="nx">paypalResponse</span> <span class="o">=</span> <span class="nx">payment</span><span class="p">;</span>
              <span class="c1">//redirect to PayPal - for user approval of the payment</span>
              <span class="nx">$window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">paypalResponse</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
            <span class="p">})</span>
            <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="s1">'PayPal error: '</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="s1">'Other error occurred, possibly with your API'</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span>
</code></pre>
<p>Once you&#39;ve got the server-side action, you are just about ready to start accepting payments. The code to the right performs two tasks. It first calls a service to prepare the payment (the Payment API in PayPal), which returns a URL to which the user is redirected.</p>

<blockquote>
<p>Client-side finalize payment code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code>      <span class="c1">//check if this is a redirect from PayPal , after the user approves the payment</span>
      <span class="c1">// PayPal adds PayerID and  paymentId to the return url we give them</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">$location</span><span class="p">.</span><span class="nx">search</span><span class="p">().</span><span class="nx">PayerID</span> <span class="o">&amp;&amp;</span> <span class="nx">$location</span><span class="p">.</span><span class="nx">search</span><span class="p">().</span><span class="nx">paymentId</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">//Call Backand action to approve the payment by the facilitator</span>
        <span class="nx">BackandService</span><span class="p">.</span><span class="nx">makePayPalApproval</span><span class="p">(</span><span class="nx">$location</span><span class="p">.</span><span class="nx">search</span><span class="p">().</span><span class="nx">PayerID</span><span class="p">,</span> <span class="nx">$location</span><span class="p">.</span><span class="nx">search</span><span class="p">().</span><span class="nx">paymentId</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">payment</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// remove PayPal query string from url</span>
            <span class="nx">$location</span><span class="p">.</span><span class="nx">url</span><span class="p">(</span><span class="nx">$location</span><span class="p">.</span><span class="nx">path</span><span class="p">());</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="s1">'successfully submitted payment for $'</span> <span class="o">+</span> <span class="nx">payment</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">transactions</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">amount</span><span class="p">.</span><span class="nx">total</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">}</span>
</code></pre>
<p>Once the user has accepted or canceled the payment, PayPal redirects them back to the URL that was provided to the server-side action. In this example, we use the same page by checking the query string parameter <code>paymentid</code>. This allows the code to detect which stage of the payment process we are at.</p>

<blockquote>
<p>Client-side code to contact custom actions for paypal</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code>  <span class="c1">//Call PayPalPayment on demand action</span>
  <span class="nx">factory</span><span class="p">.</span><span class="nx">makePayPalPayment</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/items/1'</span><span class="p">,</span>
        <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">name</span><span class="p">:</span> <span class="s1">'PayPalPayment'</span><span class="p">,</span>
          <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">amount</span><span class="p">:</span> <span class="nx">amount</span><span class="p">,</span>
            <span class="na">process</span><span class="p">:</span><span class="s2">"payment"</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">};</span>

    <span class="c1">//Call PayPalApproval on demand action</span>
    <span class="nx">factory</span><span class="p">.</span><span class="nx">makePayPalApproval</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">payerId</span><span class="p">,</span> <span class="nx">paymentId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/items/1'</span><span class="p">,</span>
        <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">name</span><span class="p">:</span> <span class="s1">'PayPalPayment'</span><span class="p">,</span>
          <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">payerId</span><span class="p">:</span> <span class="nx">payerId</span><span class="p">,</span>
            <span class="na">paymentId</span><span class="p">:</span> <span class="nx">paymentId</span><span class="p">,</span>
            <span class="na">process</span><span class="p">:</span><span class="s2">"approval"</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">};</span>
</code></pre>
<p>Once this code has been added to your project, we need to implement the service that calls Backand&#39;s server side payment action. This service wraps a HTTP request to the on-demand custom action that we created earlier in the tutorial. It assumes the action name is <code>PayPalPayment</code>, so be sure to change it as appropriate to match your actual implementation. With that, we&#39;ve added the basic code necessary to contact PayPal and record a payment.</p>
<h3 id='conclusion-2'>Conclusion</h3>
<p>The above code gives us the basis of a payments system. It can accept payments from a user, which are recorded against your own PayPal account. You can use this as a starting point for a larger application that provides a deeper integration with PayPal&#39;s API. Simply follow the pattern of wrapping the API calls in server-side actions, then calling those actions via the Backand API, and you&#39;ll have a solution built very rapidly that is both secure and scalable from day one.</p>
<h2 id='segment-io'>Segment.io</h2>
<p>There are a large number of web analytics tools available that can help your marketing team understand both how many users are using your product, and what they are doing while they use it. Implementing these services in your Backand application is as simple as any other third-party API integration. Segment.io allows you to implement an analytics API and send it to almost any notification tool available, depending on your infrastructure needs. Normally this type of integration would be done on the client side, but there are some instances where a server-side integration is useful. In this example, we will look at implementing a Segment.io integration with your Backand application using a custom server-side action.</p>
<h3 id='server-side-action-4'>Server-side Action</h3>
<blockquote>
<p>Server-Side Action Code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="cm">/* globals
 $http - Service for AJAX calls
 CONSTS - CONSTS.apiUrl for Backands API URL
 */</span>
<span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">backandCallback</span><span class="p">(</span><span class="nx">userInput</span><span class="p">,</span> <span class="nx">dbRow</span><span class="p">,</span> <span class="nx">parameters</span><span class="p">,</span> <span class="nx">userProfile</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// write your code here</span>

  <span class="kd">var</span> <span class="nx">writeKey</span> <span class="o">=</span> <span class="s1">'YOUR_SEGMENT_IO_WRITE_KEY'</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">authorization</span> <span class="o">=</span> <span class="s1">'Basic '</span> <span class="o">+</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">writeKey</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">segmentUrl</span> <span class="o">=</span> <span class="s1">'https://api.segment.io/v1/identify'</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">segmontPostResponse</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">(</span>
    <span class="p">{</span>
      <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.segment.io/v1/identify'</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"userId"</span><span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>
        <span class="s2">"traits"</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">"email"</span><span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">userId</span><span class="p">,</span>
          <span class="s2">"ActiveApps"</span><span class="p">:</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">activeApp</span>
        <span class="p">},</span>


        <span class="s2">"integrations"</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">"All"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="s2">"Woopra"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="s2">"Intercome"</span><span class="p">:</span><span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s1">'Authorization'</span><span class="p">:</span> <span class="nx">authorization</span><span class="p">,</span> <span class="s1">'Accept'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">,</span> <span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span><span class="p">}</span>

    <span class="p">});</span>

  <span class="k">return</span> <span class="nx">segmontPostResponse</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>We&#39;ll start by adding a new custom server-side action.  This action will execute JavaScript code that sends user identification data to segment.io (and, from there, to Woopra, or Intercom, or any other interested service). The code takes two parameters - <code>userId</code> and <code>activeApp</code>, with the <code>userId</code> being the user&#39;s email address. You can also send Segment.io data collected from Backand using a query to obtain the data you have stored on a given user.</p>
<h3 id='client-side-integration-4'>Client-side Integration</h3>
<p>This code has no client-side component.</p>
<h2 id='twilio'>Twilio</h2>
<p><a href="https://www.twilio.com">Twilio</a> takes care of dealing with messy telecom hardware, exposing a globally available cloud API that developers can interact with to build intelligent and complex communications systems. As your app&#39;s usage scales up or down, Twilio automatically scales with you.</p>
<h3 id='who-is-twilio-for'>Who is Twilio for?</h3>
<p>Twilio is for anyone that needs to send SMS, MMS, or VoIP, along with a lot of other communication channels embedded into web, desktop, and mobile software.</p>
<h3 id='send-sms-with-twilio-api'>Send SMS with Twilio API</h3>
<blockquote>
<p>Server-Side Action code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persisitent"><code><span class="cm">/* globals
  $http - Service for AJAX calls
  CONSTS - CONSTS.apiUrl for Backands API URL
  Config - Global Configuration
  socket - Send realtime database communication
  files - file handler, performs upload and delete of files
  request - the current http request
*/</span>
<span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">backandCallback</span><span class="p">(</span><span class="nx">userInput</span><span class="p">,</span> <span class="nx">dbRow</span><span class="p">,</span> <span class="nx">parameters</span><span class="p">,</span> <span class="nx">userProfile</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// write your code here</span>
    <span class="kd">var</span> <span class="nx">ACCOUNT_SID</span> <span class="o">=</span> <span class="s1">'AC2933cadba659d1f15bd409333e3bc38b'</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">AUTH_TOKEN</span> <span class="o">=</span> <span class="s1">'e924350f6eefb5dd1ae011b49d5cb5dd'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">FROM_PHONE_NUM</span> <span class="o">=</span> <span class="s1">'GetEat'</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">basicUrl</span> <span class="o">=</span> <span class="s1">'https://api.twilio.com/2010-04-01/Accounts/'</span> <span class="o">+</span> <span class="nx">ACCOUNT_SID</span> <span class="o">+</span> <span class="s1">'/'</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">action</span> <span class="o">=</span> <span class="s1">'Messages.json'</span> <span class="c1">// twilio have many services</span>

    <span class="k">return</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">basicUrl</span> <span class="o">+</span> <span class="nx">action</span><span class="p">,</span>
        <span class="na">data</span><span class="p">:</span>
            <span class="s1">'Body='</span> <span class="o">+</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">message</span> <span class="o">+</span>
            <span class="s1">'&amp;To='</span>  <span class="o">+</span> <span class="nx">parameters</span><span class="p">.</span><span class="nx">to</span> <span class="o">+</span>
            <span class="s1">'&amp;From='</span><span class="o">+</span> <span class="nx">FROM_PHONE_NUM</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"Accept"</span><span class="p">:</span><span class="s2">"Accept:application/json"</span><span class="p">,</span>
            <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/x-www-form-urlencoded"</span><span class="p">,</span>
            <span class="s2">"Authorization"</span><span class="p">:</span> <span class="s1">'basic '</span> <span class="o">+</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">ACCOUNT_SID</span> <span class="o">+</span> <span class="s1">':'</span> <span class="o">+</span> <span class="nx">AUTH_TOKEN</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">});</span>

<span class="p">}</span>
</code></pre>
<p>Twilio has an API that you can use to send SMS. By translating their provided cURL commands to Angular $http calls, you can easily integrate Twilio with Backand.</p>

<p>To send SMS with Twilio, you need to create a server side action. You can either trigger this action with an object&#39;s CRUD event handler, or call it on-demand from your client code. The example code demonstrates the on-demand option. In the Backand dashboard, open the Actions tab for one of your application&#39;s objects (<strong>Database --&gt; Objects --&gt; &lt;object name&gt;, actions tab</strong>), and create a new on-demand server-side JavaScript action. Learn more how to create actions <a href="#custom-actions">here</a>. Name the action <code>TwilioSendSMS</code>, add <code>to</code> and <code>message</code> to the Input Parameters, and paste the server-side code in the code editor.</p>

<p>In the example app we&#39;re building, the app&#39;s users can send a SMS message to a phone number. The phone number is sent, from the client side, in the <code>to</code> parameter, while the message content is sent in the <code>message</code> parameter.</p>
<h3 id='setup-a-free-account-in-twilio'>Setup a FREE account in Twilio</h3>
<p>After you register with Twilio, you can get your Twilio phone number <a href="https://www.twilio.com/user/account/phone-numbers/getting-started">here</a>:</p>

<ol>
<li>To choose a different phone number from the one provided, click on <em>&#39;Don&#39;t like this one? Search for a different number.&#39;</em> and select SMS in capabilities.</li>
<li>Replace the <code>FROM_PHONE_NUM</code> in the code with the Twilio phone number obtained in the prior step (dont forget the (+) sign before the number)</li>
<li>Make sure you replace the &#39;<code>ACCOUNT_SID</code>&#39; and &#39;<code>AUTH_TOKEN</code>&#39; in the code with your Twilio API keys (from the getting started page). Simply click on &#39;Show API Credentials&#39; on the right side of  &#39;Get Started with Phone Numbers,&#39; and than you&#39;ll see the <code>ACCOUNT SID</code> and <code>AUTH TOKEN</code> values.</li>
</ol>
<h3 id='setup-client-side-code'>Setup client-side code:</h3>
<blockquote>
<p>Client-Side Code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persisitent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;'</span><span class="p">,</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'TwilioSendSMS'</span><span class="p">,</span>
      <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">message</span><span class="p">:</span> <span class="s1">'Anything you can put your mind on'</span><span class="p">,</span>
        <span class="na">to</span><span class="p">:</span> <span class="s1">'&lt;your destination phone number&gt;'</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre>
<p>Next, add the client-side JavaScript code to your app&#39;s code base. Replace <code>&lt;your object name&gt;</code> with the object associated with the action you created and <code>&lt;your destination phone number&gt;</code> with a vaild phone number (when using Twilio trial account you first need to validate this phone number), Once this is done, you&#39;ll be able to easily trigger SMS via Twilio using Backand&#39;s custom action API.</p>
<h2 id='netmera'>Netmera</h2>
<p>Netmera is a cloud based service that can be used to send Push Notifications to various platforms, among other services such as Exception reporting. It offers a friendly site where campaigns (push notifications) can be managed and customized and a REST API to send push notifications automatically. In this guide you can find out how to get started on Netmera and send push notifications with Backand.</p>
<h3 id='get-started-with-netmera'>Get Started with Netmera</h3>
<ol>
<li>Register to Netmera</li>
<li>Download the Netmera SDK from <a href="https://netmera.readme.io/docs/android-sdk-download">here</a> or their <a href="https://cp.netmera.com/nm/admin/sdkDownload/overview/android/final?isNewProject=true">starter app</a>.</li>
<li>Check out their guide to <a href="https://netmera.readme.io/docs/android-guide">set up your app/the starter app with the Netmera SDK</a></li>
<li>Follow this <a href="https://netmera.readme.io/docs/netmera-push-notification-android">Android guide</a> and <a href="https://netmera.readme.io/docs/netmera-push-notification-ios">iOS guid</a> to configure push notifications on the app and get the key from Google Cloud Messaging. If you use the starter app you only need the first 3 steps to get started (unless you want to trigger advanced features like tags).</li>
<li>For Ionic you would need to implement the SDK for <a href="https://netmera.readme.io/docs/phonegap">PhoneGap Plugin</a></li>
</ol>
<h3 id='integrating-netmera-with-backand'>Integrating Netmera with Backand</h3>
<p>Netmera has a rest API that can be used to remotely send push notifications. You can integrate Netmera with Backand by using Backand server-side actions. You can either trigger this action with an object&#39;s CRUD event handler, or call it on-demand from your client code.</p>

<p>In the Backand dashboard, open the Actions tab for one of your application&#39;s objects, and create a new on-demand server-side JavaScript action by clicking on <code>Netmera</code> under &#39;Push Notifications&#39;.</p>

<p><strong>You have just created your first push notification action!</strong></p>

<blockquote>
<p>Client-Side code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;'</span><span class="p">,</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'SendPushNotification'</span><span class="p">,</span>
      <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">notificationTitle</span><span class="p">:</span> <span class="s1">'My First Push Notification'</span><span class="p">,</span>
        <span class="na">notificationContent</span><span class="p">:</span> <span class="s1">'Hello! This is my first notification!'</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<p>In order to call the function from your angular app, use the following code:</p>

<p>Replace ‘your object name’ with the object associated with the action you created, set a title for the &#39;notificationTitle&#39; field, write any message you want in ‘notificationContent’ field and you’re good to go. Now you can start sending push notifications dynamically using Backand and Netmera.</p>
<h2 id='pushwoosh'>PushWoosh</h2>
<p>Pushwoosh is a cloud based service that can be used to send Push Notifications to various platforms. It offers a friendly site where push notifications can be sent and customized and an API to send push notifications automatically. In this guide you can find out how to get started on PushWoosh with an example app for Android and send push notifications with Backand.</p>
<h3 id='get-started-with-pushwoosh'>Get Started with PushWoosh</h3>
<ol>
<li>Register an account in PushWoosh and proceed to create an application. Using the PushWoosh control panel, configure your application to support Android including <a href="http://docs.pushwoosh.com/docs/gcm-configuration">configuring GCM (Google Cloud Messaging</a>)</li>
<li>You can either get the starter app or to integrate in an existing app.
&gt; To get a starter app: clone the PushWoosh Android SDK:</li>
</ol>
<pre class="highlight shell"><code>git clone https://github.com/Pushwoosh/pushwoosh-android-sdk.git
</code></pre>
<blockquote>
<p>Then, open /Samples/Android-Simple directory in Android Studio and build the app.</p>
</blockquote>

<ol>
<li>To integrate in an existing app use the following <a href="http://docs.pushwoosh.com/docs/native-android-sdk">Android guide</a> – include the SDK.jar and add the relevant code to your application.

<ul>
<li><a href="http://docs.pushwoosh.com/docs/androidmanifestxml-modifications">Make the relevant changes to your AndroidManifest.xml file</a> – if you&#39;re using the starter app just change the App ID and Project ID.</li>
</ul></li>
<li>To integrate in an existing app use the following <a href="http://docs.pushwoosh.com/docs/apns-configuration">iOS guide</a></li>
<li>For Ionic you would need to implement the SDK for <a href="http://docs.pushwoosh.com/docs/cordova-phonegap">Cordova / PhoneGap</a> and check this example for <a href="http://docs.pushwoosh.com/docs/phonegap-build">PhoneGap Build</a></li>
</ol>
<h3 id='integrating-pushwoosh-with-backand'>Integrating PushWoosh with Backand</h3>
<p>PushWoosh has an API that can be used to send Push Notifications. You can integrate PushWoosh with Backand by using Backand server-side actions. You can either trigger this action with an object&#39;s CRUD event handler, or call it on-demand from your client code.</p>

<p>In the Backand dashboard, open the Actions tab for one of your application&#39;s objects, and create a new on-demand server-side JavaScript action by clicking on &#39;PushWoosh&#39; under &#39;Push Notifications&#39;.</p>

<p><strong>You have just created your first push notification action!</strong></p>

<blockquote>
<p>Client-side code</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;'</span><span class="p">,</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'SendPushNotification'</span><span class="p">,</span>
      <span class="na">parameters</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">notificationContent</span><span class="p">:</span> <span class="s1">'Hello! This is a push notification!'</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<p>In order to call the function from your angular app, use the provided code. Replace <code>&lt;your object name&gt;</code> with the object associated with the action you created, write any message you want in <code>‘notificationContent’</code> field, and you’re good to go. Now you can start sending push notifications dynamically using Backand.</p>
<h2 id='facebook-messenger-bot'>Facebook Messenger Bot</h2>
<p><img align="right" src="https://www.backand.com/wp-content/uploads/2016/09/bot-iphone.png"></p>

<p>Facebook recently opened up their Messenger platform to enable bots to converse with users through Facebook Apps and on Facebook Pages. In support of this, the Facebook Messenger team created a comprehensive set of <a href="https://developers.facebook.com/docs/messenger-platform/quickstart">documentation</a> describing the functionality on offer. While they offer a lot of functionality and platform-level integration for free, you still need to create a publicly-accessible application that Facebook can communicate with in order to automatically interact with your end users.</p>

<p>In this tutorial, we&#39;ll walk through creating your own messenger bot on the Backand backend-as-a-service system, and make it live - all in 10 minutes.</p>
<h3 id='demo'>Demo</h3>
<p>You can chat with the simple bot example to see the end result at <a href="http://m.me/1150283998341709" target="\_blank">http://m.me/1150283998341709</a></p>
<h3 id='getting-started'>Getting Started</h3>
<p>Messenger bots are programs that receive messages from an interface, process those messages, and then send results back to the caller. These results are then displayed to the user by the controlling application - Facebook Messenger in this case. A bot&#39;s response can be as simple as echoing text back to the user, or as complex as ordering and shipping new computer components to the end user. The only restrictions are that the bot is authenticated to communicate with Facebook, and that Facebook has approved the bot and allows it to communicate with the world at large.</p>

<p>Luckily, Backand handles the majority of the server and connectivity functionality for you, allowing you to focus on building out responsive content.</p>
<h3 id='em-building-the-server-em'><em>Building the server</em></h3>
<p>Follow these steps to build out the back-end to your bot:</p>

<ol>
<li><p>Sign up for free at <a href="https://www.backand.com">backand.com</a> (if you don&#39;t already have an account).</p></li>
<li><p>Create a new app in the Backand dashboard, then navigate to that app&#39;s management page.</p></li>
<li><p>In the new app, open menu <strong>Database --&gt; Objects --&gt; Items</strong>, and click on the <strong>Actions</strong> tab. In the <strong>Actions</strong> tab, click on the <strong>Facebook Messenger Bot</strong> template.</p></li>
<li><p>Click <strong>Save</strong></p></li>
</ol>

<p>At this point you have a back-end server that is ready to integrate with Facebook Messenger. However, you need to make a few more configuration changes before you&#39;re ready to test.</p>
<h4 id='em-create-a-facebook-app-and-page-em'><em>Create a Facebook App and Page</em></h4>
<p>Once you have the back-end and are ready to integrate, the first thing you need to do is create a Facebook Page at <a href="https://www.facebook.com/pages/create/?ref_type=pages_browser">https://www.facebook.com/pages/create/?ref_type=pages_browser</a>. This page will serve as the central integration point between your Backand application and Facebook, as the messenger bot is authorized to interact with Facebook on behalf of this page.</p>
<h5 id='facebook-app-creation'>Facebook App Creation</h5>
<p>Once you have the app&#39;s page up and running, you need to configure the Facebook integration. To do so:</p>

<ul>
<li>Add a new app at <a href="https://developers.facebook.com/quickstarts/?platform=web">https://developers.facebook.com/quickstarts/?platform=web</a>. Name it and click &quot;Create New Facebook App ID&quot;:</li>
</ul>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-create-new-app.png" alt="image" /></p>

<ul>
<li>Add an email address, select your app&#39;s category, and add a web site for your app (any URL is OK):</li>
</ul>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-create-new-app-info.png" alt="image" /></p>

<ul>
<li>Next, skip the quick start and go to the App Dashboard and click <strong>Add Product</strong> under the heading <strong>Product Settings</strong>. Once there, select <strong>Messenger</strong> from the available options:</li>
</ul>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-add-new-product-1.png" alt="image" /></p>
<h5 id='em-setup-webhooks-em'><em>Setup Webhooks</em></h5><pre class="highlight shell"><code>https://api.backand.com/1/objects/action/items?
<span class="nv">name</span><span class="o">=</span>FBMessengerBot&amp;Authorization<span class="o">=</span>basic+&lt;master token&gt;:&lt;user key&gt;
</code></pre>
<p>Once the app page is created, and the app is registered, you need to tell Facebook where to send its messages for processing. You can do this with the following steps:</p>

<ul>
<li>In the <strong>Webhooks</strong> section, click <strong>Setup Webhooks</strong>.</li>
</ul>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-set-webhook1.png" alt="image" /></p>

<ul>
<li>Enter the URL for the webhook - this should link back to your Backand application, and will resemble the URL to the right</li>
</ul>

<aside class="notice">The webhook URL uses Backand's <a href="#basic-authentication">basic authentication</a>.
You can find the '&lt;master token&gt;' in the <strong>Security --> Social & Keys</strong> section.
It also requires a '&lt;user key&gt;' for your app - you can find this in the <strong>Admin --> Team</strong> section. Simply click on the key icon near one of the Admins to obtain the user key.</aside>

<ul>
<li><p>Verify Token: <code>my_test_token</code></p></li>
<li><p>Select <code>message_deliveries</code>, <code>messages</code>, <code>messaging_options</code>, and <code>messaging_postbacks</code> under Subscription Fields.</p></li>
</ul>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-setup-webhook.png" alt="image" /></p>
<h5 id='em-get-a-page-access-token-em'><em>Get a Page Access Token</em></h5>
<p>Once you&#39;ve configured the app in Facebook, it&#39;s time to tie it back into your Backand application. In the Token Generation section, select your Page. A &#39;Page Access Token&#39; will be generated for you. Copy this &#39;Page Access Token&#39;, and navigate back to your Backand app. Open the <strong>Action</strong> section of your <strong>Items</strong> object, and paste the token into the Backand Action where indicated (<code>PAGE_ACCESS_TOKEN</code>).</p>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-select-page.png" alt="image" /></p>
<h5 id='em-subscribe-the-app-to-the-page-em'><em>Subscribe the App to the Page</em></h5>
<p>Finally, you need to subscribe to the webhooks available for your page. This is managed in the <strong>Webhooks</strong> section of the Facebook configuration:</p>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-page-subscribe.png" alt="image" /></p>
<h4 id='em-run-the-bot-em'><em>Run the Bot</em></h4>
<p>At this point, you&#39;re ready to test your bot! Navigate to your Facebook Page and send it a message using Facebook Messenger. You should see the same message echoed back to you with a prefix of &quot;Back&amp; bot says:&quot;. This is also sent to the javascript console for immediate analysis.</p>

<p><img src="https://www.backand.com/wp-content/uploads/2016/09/bot-facebook-page.png" alt="image" /></p>

<p><strong>At this point your basic bot is working. From here, you can customize the bot&#39;s server side to build out functionality for your users</strong></p>
<h3 id='how-to-share-your-bot'>How to share your bot</h3>
<p>A bot is only useful if people choose to interact with it. Below are some methods you can use to advertise your bot and draw in users.</p>
<h4 id='em-add-a-chat-button-to-your-webpage-em'><em>Add a chat button to your webpage</em></h4>
<p>As a part of their initial documentation, Facebook provided an easy method to add a Chat button to your website. The documentation on how to do this is available <a href="https://developers.facebook.com/docs/messenger-platform/plugin-reference">here</a>.</p>
<h5 id='em-create-a-shortlink-em'><em>Create a shortlink</em></h5>
<p>You can also implement a shortlink that can be used to initiate a chat with your app. Simply use a URL of the form &#39;https://m.me/&lt;PAGE_USERNAME&gt;&#39; to begin a Messenger chat.</p>
<h4 id='what-39-s-next'>What&#39;s next?</h4>
<p>At this point, you have a chatbot interacting with Facebook Messenger, driven by Backand as a back-end. You can customize the bot&#39;s code to meet your needs by following the information available in the following section of <em>Customize the Bot&#39;s Code in a Backand Action</em>.</p>

<p>You can also review Facebook&#39;s <a href="https://developers.facebook.com/docs/messenger-platform/product-overview/setup">complete guide on Messenger integration</a>, which provides more comprehensive detail on the platform&#39;s capabilities. These can be used to enhance your message responses, adding web-enabled content that your users can follow.</p>

<p>Eventually, you&#39;ll want to get your bot approved for use by the public. You can find out how to do that <a href="https://developers.facebook.com/docs/messenger-platform/app-review">here</a>.</p>

<p>Finally, you can enhance your app&#39;s intelligence with an AI integration. Find out how to get started at <a href="https://wit.ai">Wit.ai</a>!</p>
<h3 id='customizing-the-bot-39-s-code-to-em-receive-messages-em'>Customizing the Bot&#39;s Code to <em>Receive Messages</em></h3>
<blockquote>
<p>Code to receive messages from Facebook</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="k">if</span> <span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">==</span> <span class="s2">"POST"</span><span class="p">){</span>

    <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">object</span> <span class="o">==</span> <span class="s1">'page'</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// Iterate over each entry</span>
        <span class="c1">// There may be multiple if batched</span>
        <span class="nx">data</span><span class="p">.</span><span class="nx">entry</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">pageEntry</span><span class="p">)</span> <span class="p">{</span>

            <span class="kd">var</span> <span class="nx">pageID</span> <span class="o">=</span> <span class="nx">pageEntry</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">timeOfEvent</span> <span class="o">=</span> <span class="nx">pageEntry</span><span class="p">.</span><span class="nx">time</span><span class="p">;</span>

            <span class="c1">// Iterate over each messaging event</span>
            <span class="nx">pageEntry</span><span class="p">.</span><span class="nx">messaging</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">messagingEvent</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">messagingEvent</span><span class="p">.</span><span class="nx">optin</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">//receivedAuthentication(messagingEvent);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">messagingEvent</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">receivedMessage</span><span class="p">(</span><span class="nx">messagingEvent</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">messagingEvent</span><span class="p">.</span><span class="nx">delivery</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">//receivedDeliveryConfirmation(messagingEvent);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">messagingEvent</span><span class="p">.</span><span class="nx">postback</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">receivedPostback</span><span class="p">(</span><span class="nx">messagingEvent</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Webhook received unknown messagingEvent: "</span><span class="p">,</span> <span class="nx">messagingEvent</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>All callbacks and webhooks from Facebook will end up in your object&#39;s Facebook Action code. The JavaScript for this action is solely responsible for listening to the incoming <code>POST</code> calls, and responding appropriately. The template code handles all webhooks from Facebook by default. For example, receiving messages is handled by looking for the <code>messagingEvent.message</code> field in the webhook, and then calling the <code>receivedMessage()</code> function as seen to the right:</p>
<h3 id='customizing-the-bot-39-s-code-to-em-send-a-text-message-em'>Customizing the Bot&#39;s Code to <em>Send a Text Message</em></h3>
<blockquote>
<p>Sending a message to the user</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="kd">function</span> <span class="nx">receivedMessage</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">senderID</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">recipientID</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">recipient</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">timeOfMessage</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Received message for user"</span> <span class="o">+</span> <span class="nx">senderID</span> <span class="o">+</span> <span class="s2">" and page "</span> <span class="o">+</span> <span class="nx">recipientID</span> <span class="o">+</span> <span class="s2">" at "</span> <span class="o">+</span> <span class="nx">timeOfMessage</span> <span class="o">+</span> <span class="s2">" with message"</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">message</span><span class="p">));</span>

    <span class="kd">var</span> <span class="nx">messageId</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">mid</span><span class="p">;</span>

    <span class="c1">// You may get a text or attachment but not both</span>
    <span class="kd">var</span> <span class="nx">messageText</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">messageAttachments</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">attachments</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">messageText</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// If we receive a text message, check to see if it matches any special</span>
    <span class="c1">// keywords and send back the corresponding example. Otherwise, just echo</span>
    <span class="c1">// the text we received.</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">messageText</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">case</span> <span class="s1">'image'</span><span class="p">:</span>
            <span class="c1">//sendImageMessage(senderID);</span>
            <span class="k">break</span><span class="p">;</span>

          <span class="k">case</span> <span class="s1">'button'</span><span class="p">:</span>
            <span class="c1">//sendButtonMessage(senderID);</span>
            <span class="k">break</span><span class="p">;</span>

          <span class="k">case</span> <span class="s1">'backand'</span><span class="p">:</span>
          <span class="k">case</span> <span class="s1">'Backand'</span><span class="p">:</span>
            <span class="nx">sendGenericMessage</span><span class="p">(</span><span class="nx">senderID</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>

          <span class="k">case</span> <span class="s1">'receipt'</span><span class="p">:</span>
            <span class="c1">//sendReceiptMessage(senderID);</span>
            <span class="k">break</span><span class="p">;</span>

          <span class="nl">default</span><span class="p">:</span>
            <span class="nx">sendTextMessage</span><span class="p">(</span><span class="nx">senderID</span><span class="p">,</span> <span class="nx">messageText</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">messageAttachments</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">sendTextMessage</span><span class="p">(</span><span class="nx">senderID</span><span class="p">,</span> <span class="s2">"Message with attachment received"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre>
<p>In receivedMessage, we&#39;ve added logic that can send a message back to the user. The default behavior is to echo back the text that was received, with some static modifications (&#39;Back&amp; bot says&#39;...)</p>

<blockquote>
<p><code>sendTextMessage</code> formats the message to be sent to Facebook, then calls the appropriate API endpoint:</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="kd">function</span> <span class="nx">sendTextMessage</span><span class="p">(</span><span class="nx">recipientId</span><span class="p">,</span> <span class="nx">messageText</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">messageData</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">recipient</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">id</span><span class="p">:</span> <span class="nx">recipientId</span>
        <span class="p">},</span>
        <span class="na">message</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">text</span><span class="p">:</span> <span class="s2">"Back&amp; bot says: "</span> <span class="o">+</span> <span class="nx">messageText</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">callSendAPI</span><span class="p">(</span><span class="nx">messageData</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
<blockquote>
<p><code>callSendAPI</code> calls the Send API to send the message back to the user:</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="kd">function</span> <span class="nx">callSendAPI</span><span class="p">(</span><span class="nx">messageData</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span><span class="p">{</span>

        <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
            <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
            <span class="na">url</span><span class="p">:</span><span class="s2">"https://graph.facebook.com/v2.6/me/messages"</span><span class="p">,</span>
            <span class="na">params</span><span class="p">:{</span>
                <span class="s2">"access_token"</span><span class="p">:</span> <span class="nx">PAGE_ACCESS_TOKEN</span>
            <span class="p">},</span>
            <span class="na">data</span><span class="p">:</span> <span class="nx">messageData</span><span class="p">,</span>
            <span class="na">headers</span><span class="p">:{</span><span class="s2">"Content-Type"</span><span class="p">:</span><span class="s2">"application/json"</span><span class="p">}</span>
        <span class="p">});</span>

        <span class="kd">var</span> <span class="nx">recipientId</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">recipient_id</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">messageId</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">message_id</span><span class="p">;</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Successfully sent generic message with id "</span> <span class="o">+</span> <span class="nx">messageId</span> <span class="o">+</span> <span class="s2">" to recipient "</span> <span class="o">+</span> <span class="nx">recipientId</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">"Unable to send message."</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre><h3 id='customizing-the-bot-39-s-code-to-em-send-a-structured-message-em'>Customizing the Bot&#39;s Code to <em>Send a Structured Message</em></h3>
<blockquote>
<p>Sending a structured response</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="kd">function</span> <span class="nx">sendGenericMessage</span><span class="p">(</span><span class="nx">recipientId</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">messageData</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">recipient</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">id</span><span class="p">:</span> <span class="nx">recipientId</span>
        <span class="p">},</span>
        <span class="na">message</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">attachment</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">type</span><span class="p">:</span> <span class="s2">"template"</span><span class="p">,</span>
                <span class="na">payload</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">template_type</span><span class="p">:</span> <span class="s2">"generic"</span><span class="p">,</span>
                    <span class="na">elements</span><span class="p">:</span> <span class="p">[{</span>
                        <span class="na">title</span><span class="p">:</span> <span class="s2">"Messanger BAAS"</span><span class="p">,</span>
                        <span class="na">subtitle</span><span class="p">:</span> <span class="s2">"Backand as a service for Facebook Messanger"</span><span class="p">,</span>
                        <span class="na">item_url</span><span class="p">:</span> <span class="s2">"https://www.backand.com/features/"</span><span class="p">,</span>
                        <span class="na">image_url</span><span class="p">:</span> <span class="s2">"https://www.backand.com/wp-content/uploads/2016/01/endless.gif"</span><span class="p">,</span>
                        <span class="na">buttons</span><span class="p">:</span> <span class="p">[{</span>
                            <span class="na">type</span><span class="p">:</span> <span class="s2">"web_url"</span><span class="p">,</span>
                            <span class="na">url</span><span class="p">:</span> <span class="s2">"https://www.backand.com/features/"</span><span class="p">,</span>
                            <span class="na">title</span><span class="p">:</span> <span class="s2">"Open Web URL"</span>
                        <span class="p">},</span> <span class="p">{</span>
                            <span class="na">type</span><span class="p">:</span> <span class="s2">"postback"</span><span class="p">,</span>
                            <span class="na">title</span><span class="p">:</span> <span class="s2">"Call Postback"</span><span class="p">,</span>
                            <span class="na">payload</span><span class="p">:</span> <span class="s2">"Payload for first bubble"</span><span class="p">,</span>
                        <span class="p">}],</span>
                    <span class="p">},</span> <span class="p">{</span>
                        <span class="na">title</span><span class="p">:</span> <span class="s2">"3rd Party Integrations"</span><span class="p">,</span>
                        <span class="na">subtitle</span><span class="p">:</span> <span class="s2">"Connect your Bot to 3rd party services and applications"</span><span class="p">,</span>
                        <span class="na">item_url</span><span class="p">:</span> <span class="s2">"https://www.backand.com/integrations/"</span><span class="p">,</span>
                        <span class="na">image_url</span><span class="p">:</span> <span class="s2">"https://www.backand.com/wp-content/uploads/2016/01/3.png"</span><span class="p">,</span>
                        <span class="na">buttons</span><span class="p">:</span> <span class="p">[{</span>
                            <span class="na">type</span><span class="p">:</span> <span class="s2">"web_url"</span><span class="p">,</span>
                            <span class="na">url</span><span class="p">:</span> <span class="s2">"https://www.backand.com/integrations/"</span><span class="p">,</span>
                            <span class="na">title</span><span class="p">:</span> <span class="s2">"Open Web URL"</span>
                        <span class="p">},</span> <span class="p">{</span>
                            <span class="na">type</span><span class="p">:</span> <span class="s2">"postback"</span><span class="p">,</span>
                            <span class="na">title</span><span class="p">:</span> <span class="s2">"Call Postback"</span><span class="p">,</span>
                            <span class="na">payload</span><span class="p">:</span> <span class="s2">"Payload for second bubble"</span><span class="p">,</span>
                        <span class="p">}]</span>
                    <span class="p">}]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">callSendAPI</span><span class="p">(</span><span class="nx">messageData</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
<p><code>receivedMessage</code> can also send back other kinds of messages if it sees certain keywords. For example, if you send the message &#39;backand&#39;, it will call <code>sendGenericMessage()</code> - a function that sends back a Structured Message with a generic template.</p>
<h3 id='customizing-the-bot-39-s-code-to-em-handle-postbacks-em'>Customizing the Bot&#39;s Code to <em>Handle Postbacks</em></h3>
<blockquote>
<p>In our webhook handler, we handle the postback by calling the function <code>receivedPostback():</code></p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="p">....</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">messagingEvent</span><span class="p">.</span><span class="nx">postback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">receivedPostback</span><span class="p">(</span><span class="nx">messagingEvent</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre>
<p>Structured messages use <code>postbacks</code> to communicate with your application when a user clicks on one of the provided enhanced objects. The <code>postback</code> message contains the payload that was created for the button in the original Structured Message. Buttons on Structured Messages support both opening URLs and communicating via <code>postbacks</code>.</p>

<blockquote>
<p>This function sends a message back saying that the postback was called:</p>
</blockquote>
<pre class="highlight javascript tab-javascript--persistent"><code><span class="kd">function</span> <span class="nx">receivedPostback</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">senderID</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">recipientID</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">recipient</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">timeOfPostback</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">;</span>

    <span class="c1">// The 'payload' param is a developer-defined field which is set in a postback</span>
    <span class="c1">// button for Structured Messages.</span>
    <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">postback</span><span class="p">.</span><span class="nx">payload</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Received postback for user "</span> <span class="o">+</span> <span class="nx">senderID</span> <span class="o">+</span> <span class="s2">" and page "</span> <span class="o">+</span> <span class="nx">recipientID</span> <span class="o">+</span> <span class="s2">"with payload '"</span> <span class="o">+</span> <span class="nx">payload</span> <span class="o">+</span> <span class="s2">"' "</span> <span class="o">+</span>
    <span class="s2">"at "</span> <span class="o">+</span> <span class="nx">timeOfPostback</span><span class="p">);</span>

    <span class="c1">// When a postback is called, we'll send a message back to the sender to</span>
    <span class="c1">// let them know it was successful</span>
    <span class="nx">sendTextMessage</span><span class="p">(</span><span class="nx">senderID</span><span class="p">,</span> <span class="s2">"Postback called"</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
<blockquote>
<p>From here, you can expand the bot to provide a wealth of functionality to your page&#39;s users. Simply expand upon the above code until it meets your requirements.</p>
</blockquote>
<h2 id='salesforceiq'>SalesforceIQ</h2>
<p>Building and maintaining customer relationships is crucial for driving sales to your platform. However, it can also be a complex process requiring integrating data from multiple sources and, more importantly, ensuring that data is accessible when it is needed. Customer Relationship Management (CRM) software is designed to make this data management and integration process much easier, providing you with the tools you need to drive customers through your sales funnel. In this section, we&#39;ll look at integrating a Backand application with Salesforce IQ, providing you with all of the tools you need to effectively leverage your customer data in your Backand application.</p>
<h3 id='what-is-salesforceiq'>What is SalesforceIQ?</h3>
<p><a href="https://www.salesforceiq.com/">SalesforceIQ</a> is an out-of-the-box CRM solution that quickly gives you access to dynamic information tied into a full CRM solution. With Automatic Data Capture and enterprise-level intelligence under the hood, SalesforceIQ acts like your own personal assistant so you can focus on what matters most: selling. SalesforceIQ, in addition to providing easy integrations with tools like Google and Microsoft Exchange, also gives you the capability to dynamically access and manage your data through a series of robust APIs.</p>
<h3 id='connecting-a-backand-application-with-salesforceiq'>Connecting a Backand application with SalesforceIQ</h3>
<p>Integrating Backand and SalesforceIQ is as simple as leveraging the full-featured <a href="https://api.salesforceiq.com/">API</a> provided by Salesforce from within your Backand application. While traditionally you&#39;d need to make these calls to the API from a server, you can achieve the same functionality in Backand by using our custom template action. This action provides an easy-to-use code template for making calls to the SalesforceIQ API, letting you update your user tracking data based upon user activity in your Backand app, or even update your Backand app&#39;s UI based upon what you know about your user in SalesforceIQ.</p>

<p>Working with the <a href="https://api.salesforceiq.com/">SalesforceIQ API</a> provides you with full capabilities to create, retrieve, and update data on your users, as well as manage their information in SalesforceIQ. Communicating with their API is as simple as translating the cURL commands provided by Salesforce in their documentation into the appropriate $http calls that you can make from JavaScript. Simply provide the required authentication and identification headers, construct the URL, make the call, and handle the response when it arrives, dispatching it either directly to your application via a synchronous function call return, or emitting the data as an event using our Socket-based real-time communications functionality.</p>
<h3 id='the-salesforceiq-action-template'>The SalesforceIQ Action Template</h3><pre class="highlight javascript tab-javascript--persistent"><code><span class="cm">/* globals
  $http - Service for AJAX calls
  CONSTS - CONSTS.apiUrl for Backands API URL
  Config - Global Configuration
  socket - Send realtime database communication
  files - file handler, performs upload and delete of files
  request - the current http request
*/</span>
<span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">backandCallback</span><span class="p">(</span><span class="nx">userInput</span><span class="p">,</span> <span class="nx">dbRow</span><span class="p">,</span> <span class="nx">parameters</span><span class="p">,</span> <span class="nx">userProfile</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">API_KEY</span> <span class="o">=</span> <span class="s1">'-- YOUR API --'</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">API_SECRET</span> <span class="o">=</span> <span class="s1">'-- YOUR SECRET --'</span><span class="p">;</span>

    <span class="c1">//get accounts</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"https://api.salesforceiq.com/v2/accounts"</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"Accept"</span><span class="p">:</span><span class="s2">"application/json"</span><span class="p">,</span>
            <span class="s2">"Authorization"</span><span class="p">:</span> <span class="s1">'basic '</span> <span class="o">+</span> <span class="nx">btoa</span><span class="p">(</span><span class="nx">API_KEY</span> <span class="o">+</span> <span class="s1">':'</span> <span class="o">+</span> <span class="nx">API_SECRET</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>We have created an action template that will give you jump start with salesforceIQ. You can either trigger this action from an object&#39;s database transaction event actions, or create a new on-demand action that you can call from your app&#39;s client code. The sample JavaScript is provided by the template action, which is available as <strong>SalesforceIQ</strong> in the <strong>CRM &amp; ERP</strong> section of action templates.</p>

<p>This code provides you with all of the basic tools you need to get connected to the SalesforceIQ API. It takes in your SalesforceIQ API Key and API Secret, and performs a call to the <code>/accounts</code> endpoint to fetch accounts.</p>
<h3 id='connecting-this-action-to-your-salesforceiq-account'>Connecting this action to your SalesforceIQ account</h3>
<p>To connect to SalesforceIQ, you&#39;ll first need to register for an account if you haven&#39;t done so. Once you&#39;ve signed up, follow these steps to obtain your API Key and API Secret:</p>

<ol>
<li>Open Settings under the gear icon</li>
<li>Open the <strong>Integration</strong> tab under <strong>My Account Settings</strong></li>
<li>Under <strong>Create New Custom Integration</strong>, click <strong>Custom</strong></li>
<li>Set the name to <strong>Backand API</strong>, and provide a description</li>
<li>Copy the <strong>API Key</strong> and <strong>API Secret</strong> from the integration page into the JavaScript Action code</li>
<li>Click <strong>Save</strong></li>
</ol>

<p>When this is completed, you should now be able to access all of your SalesforceIQ accounts from the custom JavaScript action.</p>
<h3 id='setup-client-side-code-2'>Setup client-side code:</h3><pre class="highlight javascript tab-javascript--persistent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;'</span><span class="p">,</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'&lt;your action name&gt;'</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre>
<p>Once you&#39;ve configured the action to connect to SalesforceIQ, you&#39;ll need to call the action from your client-side code. To do so, use the JavaScript to the right to construct a GET request and trigger your SalesforceIQ action. Simply replace <code>&lt;your object name&gt;</code> with the object that contains your SalesforceIQ custom action, and replace <code>&lt;your action name&gt;</code> with the name of the action that you provided while creating the integration.</p>

<p>With these changes, you&#39;re now able to pull in any and all SalesforceIQ accounts available via their API! You can use a similar pattern to construct additional calls to the SalesforceIQ API - simply replace the URL and parameters in the custom SalesforceIQ action with the URL and parameters for the object you want to retrieve.</p>
<h2 id='salesforce-crm'>Salesforce CRM</h2>
<p>As mentioned in our section on integrating with <a href="#salesforceIQ">SalesforceIQ</a>, building and maintaining customer relationships is crucial for driving sales to your platform. However, it can also be a complex process requiring integrating data from multiple sources and, more importantly, ensuring that data is accessible when it is needed. Customer Relationship Management (CRM) software is designed to make this data management and integration process much easier, providing you with the tools you need to drive customers through your sales funnel. In this section, we&#39;ll look at integrating a Backand application with Salesforce CRM, providing you with all of the tools you need to effectively leverage your customer data in your Backand application.</p>
<h3 id='what-is-salesforce-crm'>What is Salesforce CRM?</h3>
<p><a href="https://www.salesforce.com/crm">Salesforce CRM</a> is the world&#39;s foremost CRM solution, and gives your sales teams the tools they need to close deals. Salesforce CRM is also built in the cloud, meaning that your sales team can increase their productivity and keep the sales pipeline filled with solid leads, all without the need to deploy additional hardware or work around speed limitations. Through Salesforce&#39;s <a href="https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/intro_what_is_rest_api.htm">REST API</a> you can get easy programmatic access to all of your customer data.</p>
<h3 id='connecting-a-backand-application-with-salesforce-crm'>Connecting a Backand application with Salesforce CRM</h3>
<p>Integrating Backand and SalesforceIQ is as simple as leveraging the full-featured <a href="https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/intro_what_is_rest_api.htm">REST API</a> provided by Salesforce from within your Backand application. While traditionally you&#39;d need to make these calls to the API from a server, you can achieve the same functionality in Backand by using our custom template action. This action provides an easy-to-use code template for making calls to the Salesforce REST API, letting you update your user tracking data based upon user activity in your Backand app, or even update your Backand app&#39;s UI based upon what you know about your user in Salesforce.</p>
<h3 id='the-salesforce-crm-action-template'>The Salesforce CRM Action Template</h3><pre class="highlight javascript tab-javascript--persistent"><code><span class="cm">/* globals
  $http - Service for AJAX calls
  CONSTS - CONSTS.apiUrl for Backands API URL
  Config - Global Configuration
  socket - Send realtime database communication
  files - file handler, performs upload and delete of files
  request - the current http request
*/</span>
<span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">backandCallback</span><span class="p">(</span><span class="nx">userInput</span><span class="p">,</span> <span class="nx">dbRow</span><span class="p">,</span> <span class="nx">parameters</span><span class="p">,</span> <span class="nx">userProfile</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// write your code here</span>
    <span class="kd">var</span> <span class="nx">baseUrl</span> <span class="o">=</span> <span class="s2">"https://eu11.salesforce.com/services/data/v37.0/"</span><span class="p">;</span>

  <span class="c1">// This function manages authenticating with Salesforce, providing the access</span>
  <span class="c1">// token as a return value</span>
    <span class="kd">var</span> <span class="nx">loginSalesForce</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="s2">"-- Your Client Id --"</span><span class="p">;</span> <span class="c1">//Consumer Key</span>
        <span class="kd">var</span> <span class="nx">secret</span> <span class="o">=</span> <span class="s2">"-- Your Secret Id --"</span><span class="p">;</span> <span class="c1">//Consumer Secret</span>

        <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="s2">"-- User Username --"</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">password</span> <span class="o">=</span> <span class="s2">"-- User Password --"</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">loginUrl</span> <span class="o">=</span> <span class="s2">"https://login.salesforce.com/services/oauth2/token"</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
            <span class="na">method</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
            <span class="na">url</span><span class="p">:</span> <span class="nx">loginUrl</span><span class="p">,</span>
            <span class="na">data</span><span class="p">:</span> <span class="s2">"grant_type=password"</span> <span class="o">+</span>
                <span class="s2">"&amp;username="</span> <span class="o">+</span> <span class="nx">username</span> <span class="o">+</span>
                <span class="s2">"&amp;password="</span> <span class="o">+</span> <span class="nx">password</span> <span class="o">+</span>
                <span class="s2">"&amp;client_id="</span> <span class="o">+</span>  <span class="nx">client</span> <span class="o">+</span>
                <span class="s2">"&amp;client_secret="</span> <span class="o">+</span> <span class="nx">secret</span><span class="p">,</span>
            <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">"Accept"</span><span class="p">:</span><span class="s2">"application/json"</span><span class="p">,</span>
                <span class="s2">"Content-Type"</span><span class="p">:</span> <span class="s2">"application/x-www-form-urlencoded"</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">access_token</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">access_token</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//get access token first. Check if access token exists in cookie session</span>
    <span class="kd">var</span> <span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'sf_access_token'</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">accessToken</span> <span class="o">==</span> <span class="kc">null</span><span class="p">){</span>
        <span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">loginSalesForce</span><span class="p">();</span>
        <span class="nx">cookie</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="s1">'sf_access_token'</span><span class="p">,</span> <span class="nx">accessToken</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//get list of Opportunities</span>
    <span class="kd">var</span> <span class="nx">opps</span> <span class="o">=</span> <span class="nx">$http</span><span class="p">({</span>
        <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">baseUrl</span> <span class="o">+</span> <span class="s2">"sobjects/Opportunity"</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="s2">"Authorization"</span><span class="p">:</span> <span class="s2">"Bearer "</span> <span class="o">+</span> <span class="nx">accessToken</span><span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">opps</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>We have created an action template that will give you jump start with salesforceCRM. You can either trigger this action with an object&#39;s CRUD event handler, or call it on-demand from your client code. The following is the content of the ready action template call <strong>Salesforce CRM</strong> under the <strong>CRM &amp; ERP</strong> section:</p>

<aside class="notice">The above code fetches the access token every time you call the action. You can improve the performance of this call by caching the token into a Backand Server-Side Cookie, and only performing the retrieval when the token has expired.</aside>
<h3 id='setup-access-and-get-client-and-secret-keys'>Setup access and get client and secret keys</h3>
<p>Follow these steps to obtain your Salesforce CRM authentication information:</p>

<ol>
<li>Sign in to Salesforce CRM as a user with Admin rights</li>
<li>Open <strong>Setup</strong>, found under the gear icon</li>
<li>Open <strong>App Manager</strong></li>
<li>Click on <strong>New Connected App</strong></li>
<li>Provide <strong>Connected App Name</strong>, <strong>API Name</strong>, and <strong>Contact Email</strong></li>
<li>Check <strong>Enable OAuth Settings</strong>

<ol>
<li>Check <strong>Enable for Device Flow</strong></li>
<li>Under <strong>Selected OAuth Scopes</strong>, select <strong>Full Access</strong> (or any other permissions you need)</li>
</ol></li>
<li>Click <strong>Save</strong></li>
<li>Copy <strong>Consumer Key</strong> into the client variable in the code</li>
<li>Copy <strong>Consumer Secret</strong> into the secret variable in the code</li>
</ol>

<p>Once you&#39;ve obtained the consumer key and the consumer secret, you&#39;ll need to enable server-side security in Salesforce. To do so, follow these steps:</p>

<ol>
<li>From App Manager, select your new App and Click <strong>Manage</strong></li>
<li>Click <strong>Edit Polices</strong></li>
<li>Change <strong>IP Relaxation</strong> to <strong>Relax IP Restriction</strong>, or add Backand&#39;s IP to your organization&#39;s IP restrictions</li>
<li>Change <strong>Timeout Value</strong> to 24 hours</li>
<li>Click <strong>Save</strong></li>
</ol>

<p>With that completed, you should now have full access to your CRM objects using the Salesforce REST API.</p>
<h3 id='setup-client-side-code-3'>Setup client-side code:</h3><pre class="highlight javascript tab-javascript--persistent"><code><span class="k">return</span> <span class="nx">$http</span> <span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">Backand</span><span class="p">.</span><span class="nx">getApiUrl</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'/1/objects/action/&lt;your object name&gt;'</span><span class="p">,</span>
    <span class="na">params</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'&lt;your action name&gt;'</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre>
<p>Once you&#39;ve configured the action to connect to Salesforce, you&#39;ll need to call the action from your client-side code. To do so, use the following JavaScript to construct a GET request and trigger your Salesforce action:</p>

<p>Simply replace &#39;your object name&#39; with the object that contains your Salesforce custom action, and replace &#39;your action name&#39; with the name of the action that you provided while creating the integration.</p>

<p>With these changes, you&#39;re now able to pull in any and all Salesforce accounts available via their API! You can use a similar pattern to construct additional calls to the Salesforce API - simply replace the URL and parameters in the custom SalesforceCRM action with the URL and parameters for the object you want to retrieve.</p>
<h2 id='calling-backand-from-native-android-code'>Calling Backand from Native Android Code</h2>
<blockquote>
<p>This is a simple class you can use to easily construct API requests to any Backand API URL</p>
</blockquote>
<pre class="highlight java tab-java"><code><span class="n">com</span><span class="o">.</span><span class="na">backand</span><span class="o">.</span><span class="na">backandandroidsample</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.util.Base64</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.util.Log</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.net.ssl.HttpsURLConnection</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BackandConnector</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">masterToken</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">userToken</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">appName</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">"Backand"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">BackandConnector</span><span class="o">(</span><span class="n">String</span> <span class="n">appName</span><span class="o">,</span> <span class="n">String</span> <span class="n">userToken</span><span class="o">,</span> <span class="n">String</span> <span class="n">masterToken</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">masterToken</span> <span class="o">=</span> <span class="n">masterToken</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userToken</span> <span class="o">=</span> <span class="n">userToken</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">appName</span> <span class="o">=</span> <span class="n">appName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">sendGetRequest</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">userNamePasswordCombination</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">masterToken</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">userToken</span><span class="o">;</span>
        <span class="kd">final</span> <span class="n">String</span> <span class="n">basicAuth</span> <span class="o">=</span> <span class="s">"Basic "</span> <span class="o">+</span>  <span class="n">Base64</span><span class="o">.</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">userNamePasswordCombination</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">Base64</span><span class="o">.</span><span class="na">NO_WRAP</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">{</span>

            <span class="n">HttpsURLConnection</span> <span class="n">conn</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpsURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="n">conn</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"GET"</span><span class="o">);</span>
            <span class="n">conn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
            <span class="n">conn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
            <span class="n">conn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"AppName"</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">appName</span><span class="o">);</span>

            <span class="kt">int</span> <span class="n">responseCode</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">responseCode</span> <span class="o">==</span> <span class="n">HttpsURLConnection</span><span class="o">.</span><span class="na">HTTP_OK</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
                <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>

                <span class="n">InputStreamReader</span> <span class="n">isw</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>

                <span class="kt">int</span> <span class="n">data</span> <span class="o">=</span> <span class="n">isw</span><span class="o">.</span><span class="na">read</span><span class="o">();</span>
                <span class="k">while</span> <span class="o">(</span><span class="n">data</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                    <span class="kt">char</span> <span class="n">current</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">data</span><span class="o">;</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">isw</span><span class="o">.</span><span class="na">read</span><span class="o">();</span>
                    <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">current</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"readRemoteJson: "</span> <span class="o">+</span> <span class="n">conn</span><span class="o">.</span><span class="na">getResponseMessage</span><span class="o">());</span>
                <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"readRemoteJson error: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span>  <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>As Backand is a web API, it can be used by any application that is built on top of a programming language that can make HTTP requests. As an example of this, in this section we&#39;ll look at how to connect a native Android application to a Backand back-end using HTTP calls. We&#39;ll cover configuring the connection headers, authenticating with Backand, sending requests, and receiving responses. We&#39;ll also take a brief look at how to integrate with other Backand SDK functionality.</p>
<h3 id='configuring-the-connection'>Configuring the Connection</h3>
<blockquote>
<p>This code takes three arguments - appName, userToken, and masterToken - and populates class member variables with this data. These values are then used in constructing the authentication header for each request.</p>
</blockquote>
<pre class="highlight java tab-java"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BackandConnector</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">masterToken</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">userToken</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">appName</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">"Backand"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">BackandConnector</span><span class="o">(</span><span class="n">String</span> <span class="n">appName</span><span class="o">,</span> <span class="n">String</span> <span class="n">userToken</span><span class="o">,</span> <span class="n">String</span> <span class="n">masterToken</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">masterToken</span> <span class="o">=</span> <span class="n">masterToken</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userToken</span> <span class="o">=</span> <span class="n">userToken</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">appName</span> <span class="o">=</span> <span class="n">appName</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<p>To integrate with Backand, you&#39;ll need three pieces of information. The first is the app name, which can be found in the Backand dashboard. The second is the app&#39;s Master key. This is found in the application dashboard, under <strong>Security --&gt; Social &amp; Keys</strong>. Once you&#39;ve obtained this, you&#39;ll also need the User Key. This is a key that is unique to each registered user in your application. It is used to associate the actions being taken in your app with a user, so that you can apply security templates appropriately. Obtain the User Key from <strong>Security -&gt; Registered Users</strong> - simply click on the &quot;key&quot; icon next to a user record to obtain the key:</p>

<p><img src="../images/images/user_key_icon.png" alt="image" /></p>

<p>You can store this information in a wrapper class, which you will use to govern all calls to the Backand service. Start by defining the class, along with a constructor that accepts the three authentication values.</p>
<h3 id='authenticating'>Authenticating</h3>
<blockquote>
<p>To authenticate your requests with Backand, you&#39;ll need to construct an authentication header. This consists of a Base 64-encoded string consisting of your application&#39;s master key and user key, coupled with the word &quot;Basic&quot;. The code to construct this header is as follows:</p>
</blockquote>
<pre class="highlight java tab-java"><code><span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
<span class="n">String</span> <span class="n">userNamePasswordCombination</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">masterToken</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">userToken</span><span class="o">;</span>
<span class="kd">final</span> <span class="n">String</span> <span class="n">basicAuth</span> <span class="o">=</span> <span class="s">"Basic "</span> <span class="o">+</span>  <span class="n">Base64</span><span class="o">.</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">userNamePasswordCombination</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="n">Base64</span><span class="o">.</span><span class="na">NO_WRAP</span><span class="o">);</span>
</code></pre>
<p>You can use Backand&#39;s <a href="http://docs.backand.com/#basic-authentication">Basic Authentication</a> to authenticate with your app. This uses your app&#39;s master key and a user key to authenticate API requests. This works well for server-side (and other non-visible) code, but you should be careful to ensure that your app&#39;s Master key is not exposed in source control or via your app - this key bypasses all user authentication, and can be used to perform administrative actions in your app without your knowledge.</p>
<h3 id='sending-the-request'>Sending the Request</h3>
<blockquote>
<p>This code uses the HttpsUrlConnection object from javax.net.ssl to construct a basic HTTP request to the URL specified. Set the Authorization header to the authorization value you calculated in the previous section, then use the app&#39;s name to populate the AppName header. Finally, set the content type to &quot;application/json&quot;, and open the connection.</p>
</blockquote>
<pre class="highlight java tab-java"><code><span class="kd">public</span> <span class="n">String</span> <span class="nf">sendGetRequest</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//Auth header generation code here</span>
    <span class="k">try</span> <span class="o">{</span>

        <span class="n">HttpsURLConnection</span> <span class="n">conn</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpsURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
        <span class="n">conn</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"GET"</span><span class="o">);</span>
        <span class="n">conn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="n">basicAuth</span><span class="o">);</span>
        <span class="n">conn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
        <span class="n">conn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"AppName"</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="na">appName</span><span class="o">);</span>

        <span class="c1">// handle response here.</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"readRemoteJson error: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
   <span class="c1">//return your desired result here</span>
<span class="o">}</span>
</code></pre>
<p>Once you&#39;ve built out the authentication header, you&#39;re ready to fire requests at the API. The Backand API is built as a web API, meaning that you simply need to send HTTP requests to the API URLs in order to obtain and modify your application&#39;s data. To the right is some sample code that implements a basic request to a Backand API URL</p>

<aside class="notice"> Refer to our documentation for information on obtaining the URL for your request (in the cURL language tab). We also offer URLs for all actions taken in the app dashboard's data grid for objects, as well as URLs for calling custom actions and queries - find them in the right-hand pane when testing or performing actions in the app dashboard.</aside>
<h3 id='handling-the-response'>Handling the Response</h3>
<blockquote>
<p>Below is sample code for handling a response from our API:</p>
</blockquote>
<pre class="highlight java tab-java"><code>  <span class="kt">int</span> <span class="n">responseCode</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">responseCode</span> <span class="o">==</span> <span class="n">HttpsURLConnection</span><span class="o">.</span><span class="na">HTTP_OK</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">String</span> <span class="n">line</span><span class="o">;</span>
      <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>

      <span class="n">InputStreamReader</span> <span class="n">isw</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>

      <span class="kt">int</span> <span class="n">data</span> <span class="o">=</span> <span class="n">isw</span><span class="o">.</span><span class="na">read</span><span class="o">();</span>
      <span class="k">while</span> <span class="o">(</span><span class="n">data</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
          <span class="kt">char</span> <span class="n">current</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">data</span><span class="o">;</span>
          <span class="n">data</span> <span class="o">=</span> <span class="n">isw</span><span class="o">.</span><span class="na">read</span><span class="o">();</span>
          <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">current</span><span class="o">);</span>
      <span class="o">}</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"readRemoteJson: "</span> <span class="o">+</span> <span class="n">conn</span><span class="o">.</span><span class="na">getResponseMessage</span><span class="o">());</span>
      <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre>
<p>Backand responds to your request with JSON that can be adapted however you wish. The sample code starts by obtaining the response code from the HTTP Request. If the response code indicates success, it uses InputStreamReader to read in the JSON response, to be used elsewhere in your application. Otherwise, it logs the failed request details for later debugging.</p>
<h3 id='adding-new-functionality'>Adding New Functionality</h3>
<p>At this point you have a fully-functional wrapper for calls to any Backand API. Simply create a new instance of this class, supply it with the connection information, and then make your API calls by sending URLs to the method sendGetRequest. You can easily modify this pattern to send POST, PUT, and DELETE requests as you need. Additionally, if you wish to save computation time and effort, you can abstract away the authorization header construction, saving the constructed header instead of rebuilding it every time.</p>
<h3 id='conclusion-3'>Conclusion</h3>
<p>As Backand is a web API, it can be easily integrated with nearly every programming language available. While this example focuses on Android, you can use similar code in any popular development language to communicate with Backand&#39;s API. Simply construct an authorization header using basic authentication, specify the request URL, and fire the request. Consult <a href="http://docs.backand.com">our documentation</a> to get started!</p>
<h2 id='calling-backand-from-native-ios-code'>Calling Backand from Native iOS Code</h2>
<p>While you can use a pattern similar to the method used when <a href="#calling-backand-from-native-android-code">integrating Backand with a native Android application</a>, Haijian Huo - a developer using Backand in an iOS app - has helpfully developed an SDK wrapper that reduces the complexity of calling the Backand SDK on iOS. See the project on Github at <a href="https://github.com/haijianhuo/HHBackand-iOS-SDK">https://github.com/haijianhuo/HHBackand-iOS-SDK</a>!</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
